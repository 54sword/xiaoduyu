webpackJsonp([16],{1205:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,o){try{var a=t[r](o),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)});e(s)}return i("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ResetAvatar=void 0;var c,l,u,h=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),f=n(1),p=i(f),y=(n(136),n(1320)),m=i(y),g=n(115),A=n(185),v=n(186),x=n(1251),w=n(1218),b=i(w),P=n(1217),k=i(P),E=n(1235),C=i(E),S=n(135),M=i(S),_=n(1321),T=i(_),O=t.ResetAvatar=(c=(0,A.connect)(function(e,t){return{me:(0,v.getProfile)(e)}},function(e){return{loadUserInfo:(0,g.bindActionCreators)(x.loadUserInfo,e),updateUser:(0,g.bindActionCreators)(x.updateUser,e)}}),l=(0,M.default)(T.default),c(u=l(u=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fileUpload:p.default.createElement("div",null),uploadStatus:!1},n.upload=n.upload.bind(n),n}return s(t,e),d(t,[{key:"upload",value:function(e){var t=this.props,n=t.updateUser,i=t.loadUserInfo;(0,m.default)({img:e,selectAreaScale:.9,previews:[],imgLoadComplete:function(){},done:function(){function t(e){return o.apply(this,arguments)}var o=r(regeneratorRuntime.mark(function t(r){var o,a,s,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e+"?imageMogr2/crop/!"+parseInt(r.width)+"x"+parseInt(r.height)+"a"+parseInt(r.x)+"a"+parseInt(r.y)+"/thumbnail/!200",t.next=3,n({avatar:o});case 3:a=t.sent,s=h(a,2),c=s[0],l=s[1],i({});case 8:case"end":return t.stop()}},t,this)}));return t}()})}},{key:"componentDidMount",value:function(){this.props.loadUserInfo;this.setState({fileUpload:p.default.createElement(C.default,{upload:this.upload,text:"上传头像"})})}},{key:"render",value:function(){var e=this.props.me,t=this.state,n=t.fileUpload,i=t.uploadStatus;return e._id?p.default.createElement("div",null,p.default.createElement(k.default,{title:"头像"}),i?p.default.createElement(Loading,null):null,p.default.createElement("div",{className:"card"},p.default.createElement("div",{className:"card-header"},"头像"),p.default.createElement("div",{className:"card-body"},p.default.createElement("div",{styleName:"avatar"},p.default.createElement("img",{src:e.avatar_url.replace("!50","!200")})),p.default.createElement("div",{styleName:"upload"},n),p.default.createElement("br",null),p.default.createElement("br",null)))):p.default.createElement("span",null)}}]),t}(f.Component))||u)||u);t.default=(0,b.default)(O)},1217:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Meta=void 0;var s,c,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(1),h=i(u),d=n(489),f=i(d),p=(n(115),n(185)),y=n(286),m=n(117),g=t.Meta=(s=(0,p.connect)(function(e,t){return{unreadNotice:(0,y.getUnreadNotice)(e)}},function(e){return{}}))(c=function(e){function t(e){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),l(t,[{key:"render",value:function(){var e={},t=this.props,n=t.title,i=t.description,r=t.canonical,o=t.meta,a=t.link,s=t.unreadNotice;return e.title=n?n+" - "+m.name:m.name,i&&(e.description=i),r&&(e.canonical=r),o&&(e.meta=o),a&&(e.link=a),s&&s.length>0&&(e.title="("+s.length+"条通知) "+e.title),h.default.createElement(f.default,null,h.default.createElement("title",null,s&&s.length>0?"("+s.length+"条通知)":"",n||m.name,n?" - "+m.name:""),this.props.children)}}]),t}(u.Component))||c;t.default=g},1218:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,o){try{var a=t[r](o),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)});e(s)}return i("next")})}}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(1),h=i(u),d=n(115),f=n(185),p=n(1219),y=n(1220),m=n(488),g=i(m),A=n(487),v=i(A),x=function(e){var t,n,i;return e.loadData||(e.loadData=function(e){e.store,e.match;return new Promise(function(){var e=s(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({code:200});case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}())}),(0,f.connect)(function(e,t){return{}},function(e){return{saveScrollPosition:(0,d.bindActionCreators)(p.saveScrollPosition,e),setScrollPosition:(0,d.bindActionCreators)(p.setScrollPosition,e),addVisitHistory:(0,d.bindActionCreators)(y.addVisitHistory,e)}})((i=n=function(t){function n(e){r(this,n);var t=o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.state={notFoundPgae:""},t}return a(n,t),l(n,[{key:"componentWillMount",value:function(){var e=this.props.location,t=(e.pathname,e.search);if(this.props.location.params=t?(0,v.default)(t):{},this.props.staticContext){var n=this.props.staticContext,i=n.code,r=n.text;404==i&&(this.state.notFoundPgae=r||"404 NOT FOUND")}}},{key:"componentDidMount",value:function(){var e=this.props.location,t=e.pathname,n=e.search;this.props.setScrollPosition(t+n),this.props.addVisitHistory(t+n)}},{key:"componentWillReceiveProps",value:function(e){this.props.location.pathname+this.props.location.search!=e.location.pathname+e.location.search&&(this.componentWillUnmount(),this.props=e,this.componentDidMount())}},{key:"componentWillUnmount",value:function(){var e=this.props.location,t=e.pathname,n=e.search;this.props.saveScrollPosition(t+n)}},{key:"render",value:function(){var t=this,n=this.state.notFoundPgae;return h.default.createElement("div",{className:"container"},n?h.default.createElement("div",null,n):h.default.createElement(e,c({},this.props,{notFoundPgae:function(e){t.setState({notFoundPgae:e||"404 NOT FOUND"})}})))}}]),n}(h.default.Component),n.defaultProps={loadData:function(t){var n=t.store,i=t.match;return new Promise(function(t,r){var o=[];g.default.loadData&&o.push(g.default.loadData({store:n,match:i})),e.loadData&&o.push(e.loadData({store:n,match:i})),Promise.all(o).then(function(n){t(e.loadData?n[n.length-1]:{code:200})})})}},t=i))||t};t.default=x},1219:function(e,t,n){"use strict";function i(e){return function(t,n){t({type:"SET_SCROLL_POSITION",name:e})}}function r(e){return function(t,n){t({type:"SAVE_SCROLL_POSITION",name:e})}}Object.defineProperty(t,"__esModule",{value:!0}),t.setScrollPosition=i,t.saveScrollPosition=r},1220:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addVisitHistory=function(e){return function(t){t({type:"ADD_HISTORY",page:e})}}},1235:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,o){try{var a=t[r](o),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)});e(s)}return i("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.QiniuUploadImage=void 0;var c,l,u,h,d=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),p=n(1),y=i(p),m=n(1236),g=i(m),A=n(1238),v=(i(A),n(115)),x=n(185),w=n(1239),b=n(1240),P=(i(b),t.QiniuUploadImage=(c=(0,x.connect)(function(e,t){return{}},function(e){return{getQiNiuToken:(0,v.bindActionCreators)(w.getQiNiuToken,e)}}))((h=u=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loading:!1,files:[],token:"",url:"",uploadKey:""},n.onDrop=n._onDrop.bind(n),n.onUpload=n.onUpload.bind(n),n}return s(t,e),f(t,[{key:"componentDidMount",value:function(){function e(){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function e(){var t,n,i,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.getQiNiuToken,e.next=3,t();case 3:n=e.sent,i=d(n,2),r=i[0],o=i[1],o&&this.setState({token:o.token,url:o.url});case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"onUpload",value:function(e){var t=this,n=this.props,i=n.beforeUpload,r=n.upload,o=this.state.url;t.setState({loading:!0});var a=0;i(e),e.map(function(n){n.upload().then(function(i){i.text().then(function(i){i=JSON.parse(i),r(o+"/"+i.key,n),(a+=1)>=e.length&&t.setState({loading:!1})})})})}},{key:"_onDrop",value:function(e){(0,this.props.onDrop)(e)}},{key:"render",value:function(){if(!this.state.token)return y.default.createElement("span",null);var e=this.state,t=(e.loading,e.token,this.props),n=t.multiple,i=(t.name,t.displayLoading,t.text);return y.default.createElement(g.default,{text:i,multiple:n,accept:"image/*",token:this.state.token,onUpload:this.onUpload})}}]),t}(y.default.Component),u.defaultProps={displayLoading:!0,text:"上传图片",multiple:!0,beforeUpload:function(e){},upload:function(e){},onDrop:function(e){},onUpload:function(e){}},l=h))||l);t.default=P},1236:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,c,l,u,h=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=n(1),f=i(d),p=n(78),y=i(p);n(493);var m=n(135),g=i(m),A=n(1237),v=i(A),x=(s=(0,g.default)(v.default))((u=l=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n.onChange=n.onChange.bind(n),n.upload=n.upload.bind(n),n}return a(t,e),h(t,[{key:"onChange",value:function(e){e.preventDefault();var t=this,n=void 0;e.dataTransfer?n=e.dataTransfer.files:e.target&&(n=e.target.files);for(var i=this.props.multiple?n.length:1,r=[],o=0;o<i;o++)n[o].preview=URL.createObjectURL(n[o]),n[o].upload=function(e){return function(){return t.upload(e)}}(n[o]),r.push(n[o]);this.props.onUpload(r)}},{key:"upload",value:function(e){var t=this;if(!e||0===e.size)return null;var n=e.preview.split("/").pop()+"."+e.name.split(".").pop();return new Promise(function(i){var r=(document.querySelector('input[type="file"]'),new FormData);r.append("file",e),r.append("token",t.props.token),r.append("key",n),r.append("x:filename",e.name),r.append("x:size",e.size),fetch(t.props.uploadUrl,{method:"POST",body:r}).then(function(e){i(e)}).catch(function(e){i(e)})})}},{key:"render",value:function(){var e=this.props,t=e.text,n=e.accept,i=e.multiple;return f.default.createElement("a",{href:"javascript:void(0)",styleName:"file"},t,f.default.createElement("input",{type:"file",accept:n,multiple:i,onChange:this.onChange}))}}]),t}(f.default.Component),l.defaultProps={text:"上传图片",size:2097152,accept:"*",multiple:!0,uploadUrl:function(){return"undefined"==typeof window||"undefined"==typeof document?"":"https:"===window.location.protocol?"https://up.qbox.me/":"http://upload.qiniu.com"}(),onUpload:function(e){}},l.propTypes={token:y.default.string},c=u))||c;t.default=x},1237:function(e,t){e.exports={file:"_20RkjeJ1"}},1238:function(e,t){},1239:function(e,t,n){"use strict";function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,o){try{var a=t[r](o),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)});e(s)}return i("next")})}}function r(){var e=this;return function(t,n){return new Promise(function(){var t=i(regeneratorRuntime.mark(function t(i,r){var a,c,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.default)({api:"qiniuToken",fields:"\n          token\n          url\n        ",headers:{accessToken:n().user.accessToken}});case 2:a=e.sent,c=o(a,2),l=c[0],u=c[1],i(l?[l]:[null,u]);case 7:case"end":return e.stop()}},t,e)}));return function(e,n){return t.apply(this,arguments)}}())}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.getQiNiuToken=r;var a=n(116),s=function(e){return e&&e.__esModule?e:{default:e}}(a)},1240:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Loading=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n(1),l=i(c),u=(n(115),n(185),n(1241)),h=i(u),d=t.Loading=function(e){function t(e){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),s(t,[{key:"render",value:function(){return l.default.createElement("div",{className:h.default.loading},l.default.createElement("span",null))}}]),t}(c.Component);t.default=d},1241:function(e,t){e.exports={loading:"_1inE1j98"}},1251:function(e,t,n){"use strict";function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,o){try{var a=t[r](o),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)});e(s)}return i("next")})}}function r(e){var t=e.accessToken;return function(e,n){e({type:"ADD_ACCESS_TOKEN",accessToken:t})}}function o(){return{type:"REMOVE_ACCESS_TOKEN"}}function a(e){var t=this;return function(){var n=i(regeneratorRuntime.mark(function n(r,o){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(){var n=i(regeneratorRuntime.mark(function n(i){var r,a,s,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e._id=o().user.profile._id,t.next=3,(0,u.default)({type:"mutation",api:"updateUser",args:e,fields:"\n          success\n        ",headers:{accessToken:o().user.accessToken}});case 3:r=t.sent,a=c(r,2),s=a[0],l=a[1],i([s,l]);case 8:case"end":return t.stop()}},n,t)}));return function(e){return n.apply(this,arguments)}}()));case 1:case"end":return n.stop()}},n,t)}));return function(e,t){return n.apply(this,arguments)}}()}function s(e){var t=this;return function(){var n=i(regeneratorRuntime.mark(function n(r,o){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(){var n=i(regeneratorRuntime.mark(function n(i){var r,a,s,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.user_id=o().user.profile._id,t.next=3,(0,u.default)({type:"mutation",api:"updatePassword",args:e,fields:"\n          success\n        ",headers:{accessToken:o().user.accessToken}});case 3:r=t.sent,a=c(r,2),s=a[0],l=a[1],i([s,l]);case 8:case"end":return t.stop()}},n,t)}));return function(e){return n.apply(this,arguments)}}()));case 1:case"end":return n.stop()}},n,t)}));return function(e,t){return n.apply(this,arguments)}}()}Object.defineProperty(t,"__esModule",{value:!0}),t.loadUserInfo=void 0;var c=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.addAccessToken=r,t.removeAccessToken=o,t.updateUser=a,t.updatePassword=s;var l=n(116),u=function(e){return e&&e.__esModule?e:{default:e}}(l);t.loadUserInfo=function(e){var t=e.accessToken,n=void 0===t?null:t;return function(e,t){return new Promise(function(){var r=i(regeneratorRuntime.mark(function i(r,o){var a,s,l,h;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=n||t().user.accessToken,i.next=3,(0,u.default)({api:"selfInfo",args:{},fields:"\n        _id\n        nickname_reset_at\n        create_at\n        last_sign_at\n        blocked\n        role\n        avatar\n        brief\n        source\n        posts_count\n        comment_count\n        fans_count\n        like_count\n        follow_people_count\n        follow_topic_count\n        follow_posts_count\n        block_people_count\n        block_posts_count\n        block_comment_count\n        gender\n        nickname\n        banned_to_post\n        avatar_url\n        email\n        weibo\n        qq\n        github\n        phone\n        area_code\n        find_notification_at\n        last_find_posts_at\n        ",headers:{accessToken:n}});case 3:a=i.sent,s=c(a,2),l=s[0],h=s[1],l?r([l]):(e({type:"SET_USER",userinfo:h}),r([null,h]));case 8:case"end":return i.stop()}},i,void 0)}));return function(e,t){return r.apply(this,arguments)}}())}}},1320:function(e,t,n){"use strict";var i,r=function(){function e(e,t){this.x=e||0,this.y=t||0}function t(e,t,n,i){this.x=e||0,this.y=t||0,this.width=n||0,this.height=i||0}function n(e,t){return e.x>=t.x&&e.y>=t.y&&e.x<=t.x+t.width&&e.y<=t.y+t.height}function i(t,i){switch(!0){case!n(new e(t.x,t.y),i):case!n(new e(t.x+t.width,t.y+t.height),i):case!n(new e(t.x+t.width,t.y),i):case!n(new e(t.x,t.y+t.height),i):break;default:return!0}return!1}function r(e){return~~(.5+e)}function o(e){e&&e.stopPropagation?e.stopPropagation():window.event.cancelBubble=!0}function a(e,t,n){var i=function(e){var t=(c(e),e||window.event);n(t),o(t)};return e.attachEvent?e.attachEvent("on"+t,i):e.addEventListener(t,i,!1)}function s(){var t=document.documentElement&&document.documentElement.scrollTop?document.documentElement:document.body;return new e(t.scrollLeft,t.scrollTop)}function c(t){var n=s(),i=t||window.event;return new e(i.pageX||i.clientX+n.x,i.clientY+n.y)}function l(e,t){for(var n in t)try{e.style[n]=t[n],"opacity"===n&&(e.style.filter="alpha(opacity="+100*t[n]+")")}catch(e){console.log("set style error: "+n+":"+t[n])}}function u(e){var t=document.createElement("b");return t.innerHTML="\x3c!--[if IE "+e+"]><i></i><![endif]--\x3e",1===t.getElementsByTagName("i").length}if("undefined"!=typeof window&&"undefined"!=typeof document){var h=function(){var e=navigator.userAgent.toLowerCase();return"ipad"==e.match(/ipad/i)||"iphone os"==e.match(/iphone os/i)||"android"==e.match(/android/i)}(),d=document.getElementsByTagName("body")[0],f=function(){if(this.container=document.createElement("div"),l(this.container,{position:"fixed",width:"100%",height:"100%",top:"0px",left:"0px","z-index":9999999}),this.container.style.display="none",d.appendChild(this.container),!u(6)){var n=document.createElement("div");l(n,{position:"absolute",background:"#000",width:"100%",height:"100%",top:"0px",left:"0px",opacity:"0.6"}),this.container.appendChild(n)}if(this.pickerArea=document.createElement("div"),l(this.pickerArea,{position:"absolute",backgroundColor:"#000",boxShadow:"0 5px 50px #555"}),this.container.appendChild(this.pickerArea),this.originalImgSize=new t,this.img=document.createElement("img"),l(this.img,{position:"absolute",opacity:"0.6"}),this.pickerArea.appendChild(this.img),this.imgSrc="",this.clipArea=document.createElement("div"),l(this.clipArea,{position:"absolute"}),this.pickerArea.appendChild(this.clipArea),this.clipimg=document.createElement("img"),l(this.clipimg,{position:"absolute"}),this.clipArea.appendChild(this.clipimg),this.select=document.createElement("div"),l(this.select,{position:"absolute",width:"0px",height:"0px",backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==)",cursor:"move",border:"1px dashed rgba(255, 255, 255, .3)",margin:"-1px 0 0 -1px",zIndex:100}),this.pickerArea.appendChild(this.select),this.contact={leftTop:document.createElement("div"),rightTop:document.createElement("div"),rightBottom:document.createElement("div"),leftBottom:document.createElement("div"),topCenter:document.createElement("div"),rightCenter:document.createElement("div"),bottomCenter:document.createElement("div"),leftCenter:document.createElement("div")},h)this.select.appendChild(this.contact.rightBottom),l(this.contact.rightBottom,{position:"absolute",width:"40px",height:"40px",margin:"-22px 0 0 -22px","background-size":"100% 100%",backgroundImage:'url("data:image/NGf;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGNDREMkIzMEM0MDYxMUU1OEQwM0JDNDIzOTJCMzU5OSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGNDREMkIzMUM0MDYxMUU1OEQwM0JDNDIzOTJCMzU5OSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkY0NEQyQjJFQzQwNjExRTU4RDAzQkM0MjM5MkIzNTk5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkY0NEQyQjJGQzQwNjExRTU4RDAzQkM0MjM5MkIzNTk5Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+LQ0jrQAABtFJREFUeNrsmntM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")'});else for(var i in this.contact)this.select.appendChild(this.contact[i]),l(this.contact[i],{position:"absolute",width:u(6)||u(7)?"6px":"4px",height:u(6)||u(7)?"6px":"4px",border:"1px solid #000",background:"#fff",margin:"-3px 0 0 -3px",fontSize:"0px",lineHeight:"0",opacity:"0.5"});l(this.contact.leftTop,{top:"0%",left:"0%",cursor:"nw-resize","z-index":"20"}),l(this.contact.rightTop,{top:"0%",left:"100%",cursor:"ne-resize","z-index":"20"}),l(this.contact.rightBottom,{top:"100%",left:"100%",cursor:"se-resize","z-index":"20"}),l(this.contact.leftBottom,{top:"100%",left:"0%",cursor:"sw-resize","z-index":"20"}),l(this.contact.topCenter,{top:"0%",left:"50%",cursor:"n-resize","z-index":"10"}),l(this.contact.rightCenter,{top:"50%",left:"100%",cursor:"e-resize","z-index":"10"}),l(this.contact.bottomCenter,{top:"100%",left:"50%",cursor:"s-resize","z-index":"10"}),l(this.contact.leftCenter,{top:"50%",left:"0%",cursor:"w-resize","z-index":"10"}),this.previews=null,this.previewArea=document.createElement("div"),l(this.previewArea,{position:"absolute",top:"0%",left:"100%"}),this.pickerArea.appendChild(this.previewArea),this.bottomBar=document.createElement("div"),l(this.bottomBar,{position:"absolute",backgroundColor:"#fff",width:"100%",height:"40px",top:"100%",left:"0px",zIndex:u(6)||u(7)?"-1":""});var o=document.createElement("a"),a=document.createElement("a");o.innerHTML="Cancel",a.innerHTML="Done",this.bottomBar.appendChild(o),this.bottomBar.appendChild(a),this.pickerArea.appendChild(this.bottomBar),o.href="javascript:;",a.href="javascript:;";var s=this;a.onclick=function(){if(s.doneCallback){var e=r(s.selectArea.x/s.dragArea.width*s.originalImgSize.width),t=r(s.selectArea.y/s.dragArea.height*s.originalImgSize.height),n=r(s.selectArea.width/s.dragArea.width*s.originalImgSize.width),i=r(s.selectArea.height/s.dragArea.height*s.originalImgSize.height);s.doneCallback({x:e,y:t,width:n<=0?1:n,height:i<=0?1:i})}s.container.style.display="none"},o.onclick=function(){s.container.style.display="none"},l(o,{position:"absolute",width:"50%",textAlign:"center",fontSize:"14px",color:"#333",height:"40px",lineHeight:"40px"}),l(a,{position:"absolute",left:"50%",width:"50%",textAlign:"center",fontSize:"14px",color:"#333",height:"40px",lineHeight:"40px"}),a.onmouseover=o.onmouseover=function(){l(this,{backgroundColor:"#efefef"})},a.onmouseout=o.onmouseout=function(){l(this,{backgroundColor:"#fff"})},this.doneCallback=null,this.zoomMode="1:1",this.radian=0,this.selectAreaScale=.8,this.dragArea=new t(0,0,0,0),this.selectArea=new t(0,0,0,0),this.mouseInSelectAreaPoint=new e(0,0),this.handleMoveSelectArea=!1,this.fixedPosition=new e(0,0),this.fixedContact=new e(0,0),this.currentContact="",this.handleContack=!1};f.prototype.start=function(){this.img.src=this.imgSrc+"?_r="+(new Date).getTime();var e=this;this.img.onload=function(){e.container.style.display="",e.init(),e.updateRoundElements(),e.imgLoadComplete&&e.imgLoadComplete()}},f.prototype.updatePickerArea=function(){l(this.pickerArea,{width:this.dragArea.width+"px",height:this.dragArea.height+"px",left:"50%",top:"50%",margin:-this.dragArea.height/2-30+"px 0 0 "+-this.dragArea.width/2+"px"})},f.prototype.init=function(){this.originalImgSize.width=this.img.width,this.originalImgSize.height=this.img.height;var e=1,t=h?320:500;e=t/this.img.width,e*this.img.height>t&&(e=t/this.img.height),this.dragArea.width=this.img.width*e,this.dragArea.height=this.img.height*e;var n=r(this.dragArea.width<this.dragArea.height?this.dragArea.width*this.selectAreaScale:this.dragArea.height*this.selectAreaScale);this.selectArea.width=n,this.selectArea.height=n,this.selectArea.x=r(this.dragArea.width/2-this.selectArea.width/2),this.selectArea.y=r(this.dragArea.height/2-this.selectArea.height/2),this.clipimg.src=this.imgSrc+"?_r="+(new Date).getTime(),this.clipimg.style.width=this.dragArea.width+"px",this.clipimg.style.height=this.dragArea.height+"px",this.img.style.width=this.dragArea.width+"px",this.img.style.height=this.dragArea.height+"px",this.addEvent(),this.updatePickerArea(),this.previewArea.innerHTML="";for(var i=0,o=this.previews.length,a=0;i<o;i++){var s=this.previews[i],c=document.createElement("div");l(c,{position:"absolute",top:a+"px",marginLeft:"15px",width:s.width+"px",height:s.height+"px",backgroundImage:"url("+this.imgSrc+")",display:u(6)||u(7)||u(8)?"none":""}),this.previewArea.appendChild(c),this.previews[i]=c,a+=s.height+10}this.updatePreviews(),this.updateSelectArea(),this.updateClipArea()},f.prototype.addEvent=function(){var e=this;h?(a(this.select,"touchstart",function(t){t.preventDefault(),e.handleMoveSelectArea=!0;var n=e.getRelativelyPosition(t.touches[0]);e.mouseInSelectAreaPoint.x=n.x-e.selectArea.x,e.mouseInSelectAreaPoint.y=n.y-e.selectArea.y}),a(d,"touchend",function(t){e.handleMoveSelectArea=!1,e.handleContack=!1}),a(this.contact.leftTop,"touchstart",function(t){e.resizeSelectArea(t,{x:e.selectArea.x+e.selectArea.width,y:e.selectArea.y+e.selectArea.height},"leftTop")}),a(this.contact.rightTop,"touchstart",function(t){e.resizeSelectArea(t,{x:e.selectArea.x,y:e.selectArea.y+e.selectArea.height},"rightTop")}),a(this.contact.leftBottom,"touchstart",function(t){e.resizeSelectArea(t,{x:e.selectArea.x+e.selectArea.width,y:e.selectArea.y},"leftBottom")}),a(this.contact.rightBottom,"touchstart",function(t){e.resizeSelectArea(t,{x:e.selectArea.x,y:e.selectArea.y},"rightBottom")}),a(this.contact.topCenter,"touchstart",function(t){e.resizeSelectArea(t,{x:e.selectArea.x+e.selectArea.width/2,y:e.selectArea.y+e.selectArea.height},"topCenter")}),a(this.contact.rightCenter,"touchstart",function(t){e.resizeSelectArea(t,{x:e.selectArea.x,y:e.selectArea.y+e.selectArea.height/2},"rightCenter")}),a(this.contact.bottomCenter,"touchstart",function(t){e.resizeSelectArea(t,{x:e.selectArea.x+e.selectArea.width/2,y:e.selectArea.y},"bottomCenter")}),a(this.contact.leftCenter,"touchstart",function(t){e.resizeSelectArea(t,{x:e.selectArea.x+e.selectArea.width,y:e.selectArea.y+e.selectArea.height/2},"leftCenter")}),a(d,"touchmove",function(t){"none"!=e.container.style.display&&t.preventDefault(),e.handleMoveSelectArea&&e.mousemove(t.touches[0]),e.handleContack&&("1:1"===e.zoomMode?e.equalRatio(t.touches[0]):e.freeSize(t.touches[0])),(e.handleMoveSelectArea||e.handleContack)&&(e.updateSelectArea(),e.updatePreviews(),e.updateClipArea())})):(a(this.select,"mousedown",function(t){var n=t.button;if(null==t.which&&n--,0==n){e.handleMoveSelectArea=!0;var i=e.getRelativelyPosition(t);e.mouseInSelectAreaPoint.x=i.x-e.selectArea.x,e.mouseInSelectAreaPoint.y=i.y-e.selectArea.y}}),a(d,"mouseup",function(t){e.handleMoveSelectArea=!1,e.handleContack=!1}),a(d,"resize",function(){e.updatePickerArea()}),a(this.contact.leftTop,"mousedown",function(t){e.resizeSelectArea(t,{x:e.selectArea.x+e.selectArea.width,y:e.selectArea.y+e.selectArea.height},"leftTop")}),a(this.contact.rightTop,"mousedown",function(t){e.resizeSelectArea(t,{x:e.selectArea.x,y:e.selectArea.y+e.selectArea.height},"rightTop")}),a(this.contact.leftBottom,"mousedown",function(t){e.resizeSelectArea(t,{x:e.selectArea.x+e.selectArea.width,y:e.selectArea.y},"leftBottom")}),a(this.contact.rightBottom,"mousedown",function(t){e.resizeSelectArea(t,{x:e.selectArea.x,y:e.selectArea.y},"rightBottom")}),a(this.contact.topCenter,"mousedown",function(t){e.resizeSelectArea(t,{x:e.selectArea.x+e.selectArea.width/2,y:e.selectArea.y+e.selectArea.height},"topCenter")}),a(this.contact.rightCenter,"mousedown",function(t){e.resizeSelectArea(t,{x:e.selectArea.x,y:e.selectArea.y+e.selectArea.height/2},"rightCenter")}),a(this.contact.bottomCenter,"mousedown",function(t){e.resizeSelectArea(t,{x:e.selectArea.x+e.selectArea.width/2,y:e.selectArea.y},"bottomCenter")}),a(this.contact.leftCenter,"mousedown",function(t){e.resizeSelectArea(t,{x:e.selectArea.x+e.selectArea.width,y:e.selectArea.y+e.selectArea.height/2},"leftCenter")}),a(d,"mousemove",function(t){e.handleMoveSelectArea&&e.mousemove(t),e.handleContack&&("1:1"===e.zoomMode?e.equalRatio(t):e.freeSize(t)),(e.handleMoveSelectArea||e.handleContack)&&(e.updateSelectArea(),e.updatePreviews(),e.updateClipArea())}));var t=function(){return"none"===e.container.style.display};document.oncontextmenu=t,document.onselectstart=t,document.ondragstart=t},f.prototype.getRelativelyPosition=function(t){var n=new e(t.clientX,t.clientY);return n.x-=this.pickerArea.offsetLeft,n.y-=this.pickerArea.offsetTop,n.y=n.y<=0?0:n.y,n.y=n.y>=this.dragArea.height?this.dragArea.height:n.y,n.x=n.x<=0?0:n.x,n.x=n.x>=this.dragArea.width?this.dragArea.width:n.x,n},f.prototype.mousemove=function(e){var t=this.getRelativelyPosition(e);t.x-=this.mouseInSelectAreaPoint.x,t.y-=this.mouseInSelectAreaPoint.y,t.y=t.y<=0?0:t.y,t.y=t.y>=this.dragArea.height-this.selectArea.height?this.dragArea.height-this.selectArea.height:t.y,t.x=t.x<=0?0:t.x,t.x=t.x>=this.dragArea.width-this.selectArea.width?this.dragArea.width-this.selectArea.width:t.x,this.selectArea.y=t.y,this.selectArea.x=t.x},f.prototype.resizeSelectArea=function(e,t,n){e.preventDefault(),this.handleContack=!0,this.fixedPosition.x=r(t.x),this.fixedPosition.y=r(t.y),this.currentContact=n||"",o(this)},f.prototype.freeSize=function(e){var t=this.getRelativelyPosition(e),n=Math.abs(t.x-this.fixedPosition.x),i=Math.abs(t.y-this.fixedPosition.y);"leftCenter"==this.currentContact||"rightCenter"==this.currentContact?(this.selectArea.width=n,this.selectArea.x=t.x>this.fixedPosition.x?this.fixedPosition.x:this.fixedPosition.x-n,t.y-=this.selectArea.height):"topCenter"==this.currentContact||"bottomCenter"==this.currentContact?(this.selectArea.height=i,this.selectArea.y=t.y>this.fixedPosition.y?this.fixedPosition.y:this.fixedPosition.y-i,t.x-=this.selectArea.width):(t.x>this.fixedPosition.x&&(t.x=this.fixedPosition.x),t.y<this.fixedPosition.y&&(t.y=this.fixedPosition.y),this.selectArea.width=n,this.selectArea.height=i,t.y-=this.selectArea.height,this.selectArea.x=t.x,this.selectArea.y=t.y)},f.prototype.equalRatio=function(e){var t=this.getRelativelyPosition(e);if("leftCenter"===this.currentContact||"rightCenter"===this.currentContact||"bottomCenter"===this.currentContact||"topCenter"===this.currentContact){var n="leftCenter"==this.currentContact||"rightCenter"==this.currentContact?Math.abs(t.x-this.fixedPosition.x):Math.abs(t.y-this.fixedPosition.y);if("leftCenter"==this.currentContact||"rightCenter"==this.currentContact){var o=~~Math.abs(n/2);this.fixedPosition.y-o<=0?n=2*this.fixedPosition.y:this.fixedPosition.y+o>this.dragArea.height&&(n=2*(this.dragArea.height-this.fixedPosition.y))}else{var o=~~Math.abs(n/2);this.fixedPosition.x-o<=0?n=2*this.fixedPosition.x:this.fixedPosition.x+o>this.dragArea.width&&(n=2*(this.dragArea.width-this.fixedPosition.x))}return this.selectArea.width=n,this.selectArea.height=n,void("leftCenter"==this.currentContact||"rightCenter"==this.currentContact?(t.x>this.fixedPosition.x?this.selectArea.x=this.fixedPosition.x:this.selectArea.x=this.fixedPosition.x-n,this.selectArea.y=this.fixedPosition.y-r(n/2)):(t.y>=this.fixedPosition.y?this.selectArea.y=this.fixedPosition.y:this.selectArea.y=this.fixedPosition.y-n,this.selectArea.x=this.fixedPosition.x-r(n/2)))}var a=Math.abs(t.x-this.fixedPosition.x),s=Math.abs(t.y-this.fixedPosition.y),n=a>s?a:s;if(this.selectArea.width=n,this.selectArea.height=n,this.selectArea.y=this.fixedPosition.y,this.selectArea.x=this.fixedPosition.x-n,t.x>this.fixedPosition.x&&(this.selectArea.x+=this.selectArea.width),t.y<this.fixedPosition.y&&(this.selectArea.y=this.fixedPosition.y-this.selectArea.width),!i(this.selectArea,this.dragArea)){var c=this.fixedPosition.x,l=this.fixedPosition.y,u=this.dragArea.width-this.fixedPosition.x,h=this.dragArea.height-this.fixedPosition.y;if(t.x===this.fixedPosition.x&&t.y===this.fixedPosition.y)var n=0;else if(t.x===this.fixedPosition.x)var n=c<u?c:u;else if(t.y===this.fixedPosition.y)var n=l<h?l:h;else if(t.x>=this.fixedPosition.x&&t.y>=this.fixedPosition.y)var n=u<h?u:h;else if(t.x<=this.fixedPosition.x&&t.y>=this.fixedPosition.y)var n=c<h?c:h;else if(t.x<=this.fixedPosition.x&&t.y<=this.fixedPosition.y)var n=c<l?c:l;else if(t.x>=this.fixedPosition.x&&t.y<=this.fixedPosition.y)var n=u<l?u:l;this.selectArea.width=n,this.selectArea.height=n,this.selectArea.y=this.fixedPosition.y,this.selectArea.x=this.fixedPosition.x-n,t.x>=this.fixedPosition.x&&(this.selectArea.x+=this.selectArea.width),t.y<=this.fixedPosition.y&&(this.selectArea.y=this.fixedPosition.y-this.selectArea.width)}},f.prototype.updateSelectArea=function(){l(this.select,{left:this.selectArea.x+"px",top:this.selectArea.y+"px",width:this.selectArea.width+"px",height:this.selectArea.height+"px"})},f.prototype.updateClipArea=function(){l(this.clipArea,{left:this.selectArea.x+"px",top:this.selectArea.y+"px",width:this.selectArea.width+"px",height:this.selectArea.height+"px"}),l(this.clipimg,{left:-this.selectArea.x+"px",top:-this.selectArea.y+"px",clip:"rect("+this.selectArea.y+"px, "+(this.selectArea.x+this.selectArea.width)+"px, "+(this.selectArea.y+this.selectArea.height)+"px, "+this.selectArea.x+"px)"})},f.prototype.updatePreviews=function(){for(var e in this.previews){var t=this.previews[e],n=t.offsetWidth/this.selectArea.width,i=t.offsetHeight/this.selectArea.height;t.style.backgroundPosition=r(n*-this.selectArea.x)+"px "+r(i*-this.selectArea.y)+"px",t.style.backgroundSize=r(this.dragArea.width*n)+"px "+r(this.dragArea.height*i)+"px"}},f.prototype.updateRoundElements=function(){50===this.radian&&(this.contact.leftTop.style.display="none",this.contact.rightTop.style.display="none",this.contact.rightBottom.style.display="none",this.contact.leftBottom.style.display="none");for(var e in this.previews)this.previews[e].style.borderRadius=this.radian+"%";this.clipArea.style.borderRadius=this.radian+"%",this.clipArea.style.overflow="hidden",this.select.style.borderRadius=this.radian+"%"};var p=null;return function(e){p||(p=new f),p.imgSrc=e.img,p.doneCallback=e.done,p.imgLoadComplete=e.imgLoadComplete||null,p.radian=e.radian?e.radian:0,p.selectAreaScale=e.selectAreaScale?e.selectAreaScale:.8,p.previews=e.previews?e.previews:[{width:100,height:100},{width:50,height:50},{width:30,height:30}],p.zoomMode=e.zoomMode?e.zoomMode:"1:1",h&&(p.previews=[]),p.start()}}}();void 0!==(i=function(){return r}.call(t,n,t,e))&&(e.exports=i)},1321:function(e,t){e.exports={avatar:"_3yzuDQJ7",upload:"_3Gb5_MbM"}}});