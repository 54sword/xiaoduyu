webpackJsonp([3],{1201:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Search=void 0;var u,l,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),f=r(s),d=n(287),p=(n(491),n(487)),m=r(p),h=n(1218),y=r(h),v=n(1217),_=r(v),b=n(1262),g=r(b),w=n(1286),k=r(w),E=n(135),O=r(E),P=n(1314),C=r(P),T=t.Search=(u=(0,O.default)(C.default),(0,d.withRouter)(l=u(l=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={q:"",type:""},n.search=n.search.bind(n),n.switchType=n.switchType.bind(n),n}return i(t,e),c(t,[{key:"componentDidMount",value:function(){var e=this.props.location.params||{},t=e.q,n=void 0===t?"":t,r=e.type,o=void 0===r?"":r,a=this.refs.search;this.setState({type:o,q:decodeURIComponent(n)}),a.value=decodeURIComponent(n)}},{key:"componentWillReceiveProps",value:function(e){var t=this.refs.search;if(this.props.location.pathname+this.props.location.search!=e.location.pathname+e.location.search){var n=e.location.search?(0,m.default)(e.location.search):{},r=n.q,o=void 0===r?"":r,a=n.type,i=void 0===a?"":a;t.value=decodeURIComponent(o),this.setState({type:i,q:decodeURIComponent(o)})}}},{key:"search",value:function(e){e.preventDefault();var t=this.refs.search,n=this.state.type;if(!t.value)return t.focus();this.props.history.push("/search?q="+t.value+(n&&"user"==n?"&type=user":"")),this.setState({q:t.value})}},{key:"switchType",value:function(e){var t=this.state.q;e?this.props.history.push("/search?q="+t+"&type="+e):this.props.history.push("/search?q="+t)}},{key:"render",value:function(){var e=this,t=this.state,n=t.q,r=t.type;return f.default.createElement("div",null,f.default.createElement(_.default,{title:"搜索"}),f.default.createElement("form",{className:"container",onSubmit:this.search},f.default.createElement("div",{className:"row mb-2"},f.default.createElement("div",{className:"col-9"},f.default.createElement("input",{type:"text",className:"form-control",ref:"search",placeholder:"输入关键词搜索"})),f.default.createElement("div",{className:"col-3"},f.default.createElement("button",{type:"submit",className:"btn btn-block btn-primary"},"搜索")))),f.default.createElement("ul",{className:"nav",styleName:"tab-bar"},f.default.createElement("li",{className:"nav-item"},f.default.createElement("a",{className:"nav-link",styleName:""==r?"active":null,href:"javascript:void(0)",onClick:function(){e.switchType("")}},"帖子")),f.default.createElement("li",{className:"nav-item"},f.default.createElement("a",{className:"nav-link",styleName:"user"==r?"active":null,href:"javascript:void(0)",onClick:function(){e.switchType("user")}},"用户"))),function(){if(n)return r?"user"==r?f.default.createElement(k.default,{name:n,filters:{variables:{nickname:n}}}):void 0:f.default.createElement(g.default,{id:n,filters:{variables:{title:n,sort_by:"create_at",deleted:!1,weaken:!1}},scrollLoad:!0})}())}}]),t}(f.default.Component))||l)||l);t.default=(0,y.default)(T)},1217:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Meta=void 0;var u,l,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),f=r(s),d=n(489),p=r(d),m=(n(115),n(185)),h=n(286),y=n(117),v=t.Meta=(u=(0,m.connect)(function(e,t){return{unreadNotice:(0,h.getUnreadNotice)(e)}},function(e){return{}}))(l=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),c(t,[{key:"render",value:function(){var e={},t=this.props,n=t.title,r=t.description,o=t.canonical,a=t.meta,i=t.link,u=t.unreadNotice;return e.title=n?n+" - "+y.name:y.name,r&&(e.description=r),o&&(e.canonical=o),a&&(e.meta=a),i&&(e.link=i),u&&u.length>0&&(e.title="("+u.length+"条通知) "+e.title),f.default.createElement(p.default,null,f.default.createElement("title",null,u&&u.length>0?"("+u.length+"条通知)":"",n||y.name,n?" - "+y.name:""),this.props.children)}}]),t}(s.Component))||l;t.default=v},1218:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),f=r(s),d=n(115),p=n(185),m=n(1219),h=n(1220),y=n(488),v=r(y),_=n(487),b=r(_),g=function(e){var t,n,r;return e.loadData||(e.loadData=function(e){e.store,e.match;return new Promise(function(){var e=u(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({code:200});case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}())}),(0,p.connect)(function(e,t){return{}},function(e){return{saveScrollPosition:(0,d.bindActionCreators)(m.saveScrollPosition,e),setScrollPosition:(0,d.bindActionCreators)(m.setScrollPosition,e),addVisitHistory:(0,d.bindActionCreators)(h.addVisitHistory,e)}})((r=n=function(t){function n(e){o(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.state={notFoundPgae:""},t}return i(n,t),c(n,[{key:"componentWillMount",value:function(){var e=this.props.location,t=(e.pathname,e.search);if(this.props.location.params=t?(0,b.default)(t):{},this.props.staticContext){var n=this.props.staticContext,r=n.code,o=n.text;404==r&&(this.state.notFoundPgae=o||"404 NOT FOUND")}}},{key:"componentDidMount",value:function(){var e=this.props.location,t=e.pathname,n=e.search;this.props.setScrollPosition(t+n),this.props.addVisitHistory(t+n)}},{key:"componentWillReceiveProps",value:function(e){this.props.location.pathname+this.props.location.search!=e.location.pathname+e.location.search&&(this.componentWillUnmount(),this.props=e,this.componentDidMount())}},{key:"componentWillUnmount",value:function(){var e=this.props.location,t=e.pathname,n=e.search;this.props.saveScrollPosition(t+n)}},{key:"render",value:function(){var t=this,n=this.state.notFoundPgae;return f.default.createElement("div",{className:"container"},n?f.default.createElement("div",null,n):f.default.createElement(e,l({},this.props,{notFoundPgae:function(e){t.setState({notFoundPgae:e||"404 NOT FOUND"})}})))}}]),n}(f.default.Component),n.defaultProps={loadData:function(t){var n=t.store,r=t.match;return new Promise(function(t,o){var a=[];v.default.loadData&&a.push(v.default.loadData({store:n,match:r})),e.loadData&&a.push(e.loadData({store:n,match:r})),Promise.all(a).then(function(n){t(e.loadData?n[n.length-1]:{code:200})})})}},t=r))||t};t.default=g},1219:function(e,t,n){"use strict";function r(e){return function(t,n){t({type:"SET_SCROLL_POSITION",name:e})}}function o(e){return function(t,n){t({type:"SAVE_SCROLL_POSITION",name:e})}}Object.defineProperty(t,"__esModule",{value:!0}),t.setScrollPosition=r,t.saveScrollPosition=o},1220:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addVisitHistory=function(e){return function(t){t({type:"ADD_HISTORY",page:e})}}},1221:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=function(){this.devices={1:"unknow",2:"windows",3:"mac",4:"ipad",5:"iphone",6:"android"},this.show={1:"",2:"",3:"",4:"来自 iPad",5:"来自 iPhone",6:"来自 Android"}};return e.prototype.getCurrentDeviceId=function(){if("undefined"==typeof window||"undefined"==typeof document)return 1;var e="unknow",t=navigator.platform,n=navigator.userAgent.toLowerCase(),r={windows:0==t.indexOf("Win"),mac:0==t.indexOf("Mac"),ipad:"ipad"==n.match(/ipad/i),iphone:"iphone os"==n.match(/iphone os/i),android:"android"==n.match(/android/i)};for(var o in r)r[o]&&(e=o);for(var o in this.devices)if(this.devices[o]==e)return o;return 1},e.prototype.getNameByDeviceId=function(e){return this.show[e]},e.prototype.isMobileDevice=function(){var e=this.getCurrentDeviceId();return 5==e||6==e},new e}();t.default=r},1222:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}function a(e){var t=this,n=e.posts_id,r=e.parent_id,a=e.reply_id,u=e.contentJSON,c=e.contentHTML,s=e.deviceId;e.callback;return function(e,f){var d=(f().user.accessToken,f().comment),m=f().posts;return new Promise(function(){var h=o(regeneratorRuntime.mark(function o(h){var y,v,_,b,g,w,k,E,O;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,p.default)({type:"mutation",api:"addComment",args:{posts_id:n,parent_id:r,reply_id:a,content:u,content_html:c,device:s},fields:"\n          success\n          _id\n        ",headers:{accessToken:f().user.accessToken}});case 2:if(y=t.sent,v=l(y,2),_=v[0],b=v[1],h([_,b]),b&&b.success){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,i({name:"cache",filters:{query:{_id:b._id}},restart:!0})(e,f);case 11:g=t.sent,w=l(g,2),_=w[0],b=w[1],k=b.data[0];for(E in d)E==n?k.parent_id?d[E].data.map(function(e){e._id==k.parent_id&&e.reply.push(k)}):d[E].data.push(k):E==r&&d[E].data.push(k);if(e({type:"SET_COMMENT",state:d}),!r){for(O in m)m[O].data.map(function(e){e._id==n&&(e.comment_count=e.comment_count?e.comment_count+1:1)});e({type:"SET_POSTS",state:m})}case 19:case"end":return t.stop()}},o,t)}));return function(e){return h.apply(this,arguments)}}())}}function i(e){var t=e.name,n=e.filters,r=void 0===n?{}:n,o=e.restart,a=void 0!==o&&o;return function(e,n){return r.select||(r.select="\n        content_html\n        create_at\n        reply_count\n        like_count\n        device\n        ip\n        blocked\n        deleted\n        verify\n        weaken\n        recommend\n        _id\n        update_at\n        like\n        user_id {\n          _id\n          nickname\n          brief\n          avatar_url\n        }\n        posts_id{\n          _id\n          title\n        }\n        parent_id\n        reply_id {\n          _id\n          user_id{\n            _id\n            nickname\n            brief\n            avatar_url\n          }\n        }\n        reply {\n          _id\n          user_id {\n            _id\n            nickname\n            brief\n            avatar\n            avatar_url\n          }\n          posts_id\n          parent_id\n          reply_id {\n            user_id {\n              _id\n              nickname\n              brief\n              avatar\n              avatar_url\n            }\n          }\n          update_at\n          weaken\n          device\n          like_count\n          create_at\n          content_html\n          like\n        }\n      "),(0,f.default)({dispatch:e,getState:n,name:t,restart:a,filters:r,processList:m,schemaName:"comments",reducerName:"comment",api:"/comments",actionType:"SET_COMMENT_LIST_BY_NAME"})}}function u(e){var t=this;return function(n,r){return new Promise(function(){var a=o(regeneratorRuntime.mark(function o(a,i){var u,c,s,f,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,p.default)({type:"mutation",api:"updateComment",args:JSON.parse(JSON.stringify(e)),fields:"\n        success\n      ",headers:{accessToken:r().user.accessToken}});case 2:if(u=t.sent,c=l(u,2),s=c[0],f=c[1],!s){t.next=8;break}return t.abrupt("return",a([s]));case 8:d=e._id,delete e._id,n({type:"UPDATE_COMMENT",id:d,update:m([e])[0]}),a([null]);case 12:case"end":return t.stop()}},o,t)}));return function(e,t){return a.apply(this,arguments)}}())}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.addComment=a,t.loadCommentList=i,t.updateComment=u;var c=n(492),s=n(188),f=r(s),d=n(116),p=r(d),m=function e(t){return t.map(function(t){if(t.create_at&&(t._create_at=(0,c.DateDiff)(t.create_at)),t.content_html){var n=t.content_html.replace(/<[^>]+>/g,"");n.length>200&&(n=n.slice(0,200)+"..."),t.content_summary=n}else t.content_summary="";t.reply&&t.reply.map&&(t.reply=e(t.reply))}),t}},1223:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,c,s,f=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=n(1),m=r(p),h=n(115),y=n(185),v=n(1228),_=n(1229),b=n(186),g=n(135),w=r(g),k=n(1231),E=r(k),O=(l=(0,y.connect)(function(e,t){return{isMember:(0,b.isMember)(e)}},function(e){return{loadReportTypes:(0,h.bindActionCreators)(v.loadReportTypes,e),addBlock:(0,h.bindActionCreators)(_.addBlock,e)}}),c=(0,w.default)(E.default),l(s=c(s=function(t){function n(e){a(this,n);var t=i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.stopPropagation=t.stopPropagation.bind(t),t.report=t.report.bind(t),t.block=t.block.bind(t),t}return u(n,t),d(n,[{key:"stopPropagation",value:function(e){e.stopPropagation(),this.props.loadReportTypes()}},{key:"block",value:function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function e(t){var n,r,o,a,i,u,l,c,s,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),n=this.props,r=n.posts,o=n.user,a=n.comment,i=n.addBlock,u={},!r){e.next=7;break}u.posts_id=r._id,e.next=17;break;case 7:if(!o){e.next=11;break}u.people_id=o._id,e.next=17;break;case 11:if(!a){e.next=15;break}u.comment_id=a._id,e.next=17;break;case 15:return Toastify({text:"缺少资源",duration:3e3,backgroundColor:"linear-gradient(to right, #ff6c6c, #f66262)"}).showToast(),e.abrupt("return");case 17:return e.next=19,i({args:u});case 19:l=e.sent,c=f(l,2),s=c[0],d=c[1],d&&d.success?Toastify({text:"屏蔽成功",duration:3e3,backgroundColor:"linear-gradient(to right, #50c64a, #40aa33)"}).showToast():s&&s.message&&Toastify({text:s.message,duration:3e3,backgroundColor:"linear-gradient(to right, #ff6c6c, #f66262)"}).showToast();case 24:case"end":return e.stop()}},e,this)}));return e}()},{key:"report",value:function(t){t.stopPropagation();var n=this.props,r=n.posts,o=n.user,a=n.comment;e("#report").modal({show:!0},{posts:r,user:o,comment:a})}},{key:"render",value:function(){return this.props.isMember?m.default.createElement("span",null,m.default.createElement("a",{href:"javascript:void(0)",styleName:"menu","data-toggle":"dropdown",onClick:this.stopPropagation}),m.default.createElement("div",{className:"dropdown-menu"},m.default.createElement("a",{className:"dropdown-item",href:"javascript:void(0)",onClick:this.block},"不感兴趣"),m.default.createElement("a",{className:"dropdown-item",href:"javascript:void(0)",onClick:this.report},"举报"))):""}}]),n}(p.Component))||s)||s);t.default=O}).call(t,n(187))},1224:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,c,s,f,d,p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),m=n(1),h=r(m),y=n(78),v=r(y),_=n(115),b=n(185),g=n(1230),w=n(186),k=n(135),E=r(k),O=n(1243),P=r(O),C=(l=(0,b.connect)(function(e,t){return{me:(0,w.getProfile)(e)}},function(e){return{follow:(0,_.bindActionCreators)(g.follow,e),unfollow:(0,_.bindActionCreators)(g.unfollow,e)}}),c=(0,E.default)(P.default),l(s=c((d=f=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.follow=n.follow.bind(n),n.unfollow=n.unfollow.bind(n),n}return u(t,e),p(t,[{key:"stopPropagation",value:function(e){e.stopPropagation()}},{key:"follow",value:function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function e(t){var n,r,o,a,i,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopPropagation(),n=this.props,r=n.follow,o=n.posts,a=n.user,i=n.topic,u={},o&&(u.posts_id=o._id),a&&(u.user_id=a._id),i&&(u.topic_id=i._id),e.next=8,r({args:u});case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"unfollow",value:function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function e(t){var n,r,o,a,i,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopPropagation(),n=this.props,r=n.unfollow,o=n.posts,a=n.user,i=n.topic,u={},o&&(u.posts_id=o._id),a&&(u.user_id=a._id),i&&(u.topic_id=i._id),e.next=8,r({args:u});case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"render",value:function(){var e=this.props,t=e.me,n=e.posts,r=e.user,o=e.topic,a=n||r||o;return t&&n&&n.user_id&&n.user_id._id==t._id||t&&r&&r._id==t._id?"":t?a.follow?h.default.createElement("a",{href:"javascript:void(0)",styleName:"hover",onClick:this.unfollow},h.default.createElement("span",null,"已关注"),h.default.createElement("span",null,"取消关注")):h.default.createElement("a",{href:"javascript:void(0)",onClick:this.follow},"关注"):h.default.createElement("a",{href:"javascript:void(0)","data-toggle":"modal","data-target":"#sign",onClick:this.stopPropagation},"关注")}}]),t}(m.Component),f.propTypes={posts:v.default.object,user:v.default.object,topic:v.default.object},s=d))||s)||s);t.default=C},1225:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function l(e){e=e||32;for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=t.length,r="",o=0;o<e;o++)r+=t.charAt(Math.floor(Math.random()*n));return r}Object.defineProperty(t,"__esModule",{value:!0}),t.HTMLText=void 0;var c,s,f,d,p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),m=n(1),h=r(m),y=n(135),v=r(y),_=n(1248),b=r(_),g=n(1221),w=r(g),k=n(1249),E=r(k),O=function(e){if(!e)return"";e=e.replace("&nbsp;"," ");var t=/<a(.*?)>(.*?)<\/a>/gi,n=[],r=e.match(t);r&&r.length>0&&e.match(t).map(function(t){var r="#"+l(18)+"#";n.push({id:r,value:t}),e=e.replace(t,r)});var o=/(http:\/\/|https:\/\/|www\.|magnet\:\?xt\=)(.*?)(?=\s|http|https|\)|\>|\]|\}|\<|$)/gi,a=e.match(o);if(a&&a.length>0){var i=function(e,t){return t.length-e.length};a=a.sort(i);var u=[];a.map(function(t){var n="#"+l(18)+"#";u.push({id:n,value:t}),e=e.replace(t,n)}),u.map(function(t){e=w.default.isMobileDevice()?e.replace(t.id,"<a href="+t.value+' rel="nofollow">'+t.value+"</a>"):e.replace(t.id,"<a href="+t.value+' target="_blank" rel="nofollow">'+t.value+"</a>")})}return n.length>0&&n.map(function(t){e=e.replace(t.id,t.value)}),e},P=function(e){e=O(e);var t=/\<div data\-youku\=\"(.*?)\"\>\<\/div\>/g,n=e.match(t);n&&n.length>0&&n.map(function(n){var r=n.split(t)[1],o="//player.youku.com/embed/"+r,a='<iframe ref="iframe" src="'+o+'"></iframe>';e=e.replace(n,'<div class="load-demand" data-load-demand=\''+a+"'></div>")}),t=/\<div data\-qq\=\"(.*?)\"\>\<\/div\>/g,n=e.match(t),n&&n.length>0&&n.map(function(n){var r=n.split(t)[1],o="//v.qq.com/iframe/player.html?vid="+r+"&tiny=0&auto=0",a='<iframe ref="iframe" src="'+o+'"></iframe>';e=e.replace(n,'<div class="load-demand" data-load-demand=\''+a+"'></div>")}),t=/\<div data\-youtube\=\"(.*?)\"\>\<\/div\>/g,n=e.match(t),n&&n.length>0&&n.map(function(n){var r=n.split(t)[1],o="//www.youtube.com/embed/"+r,a='<iframe ref="iframe" src="'+o+'"></iframe>';e=e.replace(n,'<div class="load-demand" data-load-demand=\''+a+"'></div>")}),t=/\<img src\=\"(.*?)\"\>/g;var r=[].concat(u(new Set(e.match(t)))),o=E.default.abstractImagesFromHTML(e);o.map(function(e,t){o[t]=e.split("?")[0]}),o="['"+o.join("','")+"']",r&&r.length>0&&r.map(function(t,n){var r=t;r=r.replace(/\?/g,"\\?"),e=e.replace(new RegExp(r,"gm"),'<div onclick="webPictureViewer('+o+","+n+');" class="load-demand text-center" data-load-demand=\''+t+"'></div>")}),t=/\<div data\-163musicsong\=\"(.*?)\"\>/g;var a=e.match(t);return a&&a.length>0&&a.map(function(n){var r=n.split(t)[1],o="//music.163.com/outchain/player?type=2&id="+r+"&auto=0&height=66";e=e.replace(n,'<iframe type="music" ref="iframe" src="'+o+'" height="86"></iframe>')}),t=/\<div data\-163musicplaylist\=\"(.*?)\"\>/g,a=e.match(t),a&&a.length>0&&a.map(function(n){var r=n.split(t)[1],o="//music.163.com/outchain/player?type=0&id="+r+"&auto=0&height=430";e=e.replace(n,'<iframe type="music" ref="iframe" src="'+o+'" height="450"></iframe>')}),e},C=t.HTMLText=(c=(0,v.default)(b.default))((d=f=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={content:""},n}return i(t,e),p(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.content;e.hiddenHalf&&t&&(t=t.substr(0,parseInt(t.length/2))),this.state.content=P(t)}},{key:"componentWillReceiveProps",value:function(e){this.props.content!=e.content&&(this.props=e,this.componentWillMount())}},{key:"render",value:function(){var e=this.state.content,t=this.props.hiddenHalf;return h.default.createElement("div",null,h.default.createElement("div",{ref:"contentDom",className:b.default.content,dangerouslySetInnerHTML:{__html:e}}),t&&e?h.default.createElement("div",{styleName:"more-tips"},h.default.createElement("div",null,h.default.createElement("span",{styleName:"lock"},"剩余50%的内容登陆后可查看")),h.default.createElement("div",{styleName:"sign"},h.default.createElement("a",{href:"javascript:void(0)",className:"btn btn-outline-primary btn-sm","data-toggle":"modal","data-target":"#sign","data-type":"sign-up"},"注册"),h.default.createElement("a",{href:"javascript:void(0)",className:"btn btn-outline-primary btn-sm","data-toggle":"modal","data-target":"#sign","data-type":"sign-in"},"登录"))):null)}}]),t}(m.Component),f.defaultProps={hiddenHalf:!1},s=d))||s;t.default=C},1226:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Pagination=void 0;var i,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),c=function(e){return e&&e.__esModule?e:{default:e}}(l),s=n(136),f=t.Pagination=(0,s.withRouter)(i=function(e){function t(e){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),u(t,[{key:"render",value:function(){var e=this.props,t=e.location,n=e.count,r=e.pageSize,o=e.pageNumber;if(!n)return"";var a=t.pathname,i=t.search,u=Math.ceil(n/r);if(1==u)return"";i=i.split("?")[1]||"";var l=[];i.split("&").map(function(e){e&&-1==e.indexOf("page_number")&&l.push(e)}),i=i.replace("page_number="+o,"");var f=function(e){var t=e<=1?"":"page_number="+e;return 0==l.length?a+(t?"?"+t:""):a+"?"+[].concat(l,[t]).join("&")},d=o>1?f(o-1):"",p=o+1<=u?f(o+1):"";return c.default.createElement("nav",{"aria-label":"Page navigation",className:"mt-3"},c.default.createElement("ul",{className:"pagination justify-content-center"},c.default.createElement("li",{className:"page-item "+(d?"":"disabled")},c.default.createElement(s.Link,{className:"page-link",to:d,"aria-label":"Previous"},c.default.createElement("span",{"aria-hidden":"true"},"«"),c.default.createElement("span",{className:"sr-only"},"Previous"))),function(){for(var e=[],t=o-5>=1?o-5:0,n=o+4>=u?u:o+4,r=t;r<n;r++)e.push(c.default.createElement("li",{className:"page-item "+(o-1==r?"active":""),key:r},c.default.createElement(s.Link,{className:"page-link",to:f(r+1)},r+1)));return e}(),c.default.createElement("li",{className:"page-item "+(p?"":"disabled")},c.default.createElement(s.Link,{className:"page-link",to:p,"aria-label":"Next"},c.default.createElement("span",{"aria-hidden":"true"},"»"),c.default.createElement("span",{className:"sr-only"},"Next")))))}}]),t}(l.Component))||i;t.default=f},1227:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,c,s,f,d,p=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=n(1),y=r(h),v=n(288),_=n(115),b=n(185),g=n(1222),w=n(1221),k=r(w),E=n(1244),O=r(E),P=n(135),C=r(P),T=n(1252),j=r(T),x=(l=(0,b.connect)(function(e,t){return{}},function(e){return{addComment:(0,_.bindActionCreators)(g.addComment,e),updateComment:(0,_.bindActionCreators)(g.updateComment,e),loadCommentList:(0,_.bindActionCreators)(g.loadCommentList,e)}}),c=(0,C.default)(j.default),l(s=c((d=f=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={contentJSON:"",contentHTML:"",content:y.default.createElement("div",null),editor:null,showFooter:!1,submitting:!1},n.submit=n.submit.bind(n),n.syncContent=n.syncContent.bind(n),n}return u(t,e),m(t,[{key:"componentDidMount",value:function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function e(){var t,n,r,o,a,i,u,l,c,s,f,d,m,h,_;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this,n=this.props,r=n._id,o=n.parent_id,a=n.posts_id,i=n.reply_id,u=n.getEditor,l=n.loadCommentList,c="",!r){e.next=11;break}return e.next=6,l({name:"edit_"+r,filters:{query:{_id:r},select:"\n            content\n            _id\n          "},restart:!0});case 6:s=e.sent,f=p(s,2),d=f[0],m=f[1],m&&m.data&&m.data[0]&&(c=m.data[0].content);case 11:h=v.reactLocalStorage.get("comments-draft")||"{}";try{h=JSON.parse(h)||{}}catch(e){h={}}_={content:c||h[i||a]||"",syncContent:this.syncContent,getEditor:function(e){t.setState({editor:e}),u(e)},displayControls:!0,placeholder:"写评论...",getCheckUpload:function(e){t.checkUpload=e}},this.setState({content:y.default.createElement(O.default,_)});case 15:case"end":return e.stop()}},e,this)}));return e}()},{key:"submit",value:function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function e(){var t,n,r,o,a,i,u,l,c,s,f,d,m,h,v,_,b,g,w,E,P;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this,n=this.props,r=n._id,o=n.posts_id,a=n.parent_id,i=n.reply_id,u=n.successCallback,l=n.addComment,c=n.updateComment,s=n.getEditor,f=this.state,d=f.contentJSON,m=f.contentHTML,h=f.editor,v=f.submitting,!v){e.next=5;break}return e.abrupt("return");case 5:if(d){e.next=7;break}return e.abrupt("return",h.focus());case 7:if(this.checkUpload()){e.next=10;break}return Toastify({text:"有图片上传中，请等待上传完成后再提交",duration:3e3,backgroundColor:"linear-gradient(to right, #0988fe, #1c75fb)"}).showToast(),e.abrupt("return");case 10:if(t.setState({submitting:!0}),_=void 0,b=void 0,!r){e.next=21;break}return e.next=15,c({_id:r,content:d,content_html:m});case 15:g=e.sent,w=p(g,2),_=w[0],b=w[1],e.next=27;break;case 21:return e.next=23,l({posts_id:o,parent_id:a,reply_id:i,contentJSON:d,contentHTML:m,deviceId:k.default.getCurrentDeviceId()});case 23:E=e.sent,P=p(E,2),_=P[0],b=P[1];case 27:this.setState({submitting:!1}),_?_&&Toastify({text:_.message,duration:3e3,backgroundColor:"linear-gradient(to right, #ff6c6c, #f66262)"}).showToast():(this.setState({content:y.default.createElement("div",{key:(new Date).getTime()},y.default.createElement(O.default,{syncContent:t.syncContent,content:"",getEditor:function(e){t.setState({editor:e}),s(e)},displayControls:!a}))}),this.syncContent("",""),u());case 29:case"end":return e.stop()}},e,this)}));return e}()},{key:"syncContent",value:function(e,t){var n=this.props,r=n.posts_id,o=n.reply_id;this.state.contentJSON=e,this.state.contentHTML=t,!this.state.showFooter&&e&&this.setState({showFooter:!0});var a=v.reactLocalStorage.get("comments-draft")||"{}";try{a=JSON.parse(a)||{}}catch(e){a={}}var i=[];for(var u in a)i.push(u);i.length>10&&delete a[i[0]],this.state.showFooter&&(a[o||r]=e,v.reactLocalStorage.set("comments-draft",JSON.stringify(a)))}},{key:"render",value:function(){var e=this.state,t=e.content,n=e.showFooter,r=e.submitting;e.uploading;return y.default.createElement("div",{styleName:"box"},y.default.createElement("div",{styleName:"content"},t),n?y.default.createElement("div",{styleName:"footer"},y.default.createElement("button",{onClick:this.submit,type:"button",className:"btn btn-primary"},r?"提交中...":"提交")):null)}}]),t}(h.Component),f.defaultProps={_id:"",posts_id:"",parent_id:"",reply_id:"",successCallback:function(){},getEditor:function(e){}},s=d))||s)||s);t.default=x},1228:function(e,t,n){"use strict";function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}function o(){var e=this;return function(t,n){return new Promise(function(){var n=r(regeneratorRuntime.mark(function n(r,o){var a,u,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.default)({api:"fetchReportTypes",fields:"\n          success\n          data {\n            id\n            text\n          }\n        "});case 2:a=e.sent,u=i(a,2),c=u[0],s=u[1],s&&s.success&&t({type:"ADD_REPORT_TYPES",types:s.data});case 7:case"end":return e.stop()}},n,e)}));return function(e,t){return n.apply(this,arguments)}}())}}function a(e){var t=this,n=e.data;return function(e,o){return new Promise(function(){var e=r(regeneratorRuntime.mark(function e(r,a){var u,c,s,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.default)({type:"mutation",api:"addReport",args:n,fields:"success",headers:{accessToken:o().user.accessToken}});case 2:u=e.sent,c=i(u,2),s=c[0],f=c[1],r([s,f]);case 7:case"end":return e.stop()}},e,t)}));return function(t,n){return e.apply(this,arguments)}}())}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.loadReportTypes=o,t.addReport=a;var u=n(116),l=function(e){return e&&e.__esModule?e:{default:e}}(u)},1229:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.removeBlock=t.addBlock=t.loadBlockList=void 0;var a=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=n(116),u=r(i),l=n(188),c=r(l);t.loadBlockList=function(e){var t=e.id,n=e.args,r=e.select,a=e.restart;return function(e,i){return new Promise(function(){var u=o(regeneratorRuntime.mark(function o(u){var l;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return l={variables:n},r||(l.select="\n          _id\n          deleted\n          create_at\n          ip\n          user_id\n          comment_id {\n            _id\n            content_html\n            posts_id\n            parent_id\n          }\n          people_id {\n            create_at\n            avatar\n            _id\n            nickname\n            avatar_url\n            id\n          }\n          posts_id {\n            title\n            _id\n          }\n        "),o.abrupt("return",(0,c.default)({dispatch:e,getState:i,name:t,restart:a,filters:l,schemaName:"blocks",reducerName:"block",api:"/blocks",actionType:"SET_BLOCK_LIST_BY_NAME"}));case 3:case"end":return o.stop()}},o,void 0)}));return function(e){return u.apply(this,arguments)}}())}},t.addBlock=function(e){var t=e.args;return function(e,n){return new Promise(function(){var r=o(regeneratorRuntime.mark(function r(o){var i,l,c,s,f;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,u.default)({type:"mutation",api:"addBlock",args:t,fields:"\n          success\n          _id\n        ",headers:{accessToken:n().user.accessToken}});case 2:if(i=r.sent,l=a(i,2),c=l[0],s=l[1],o([c,s]),!c&&s&&s.success){r.next=9;break}return r.abrupt("return");case 9:f=n().user.profile,t.people_id?f.block_people_count?f.block_people_count+=1:f.block_people_count=1:t.posts_id?(f.block_posts_count?f.block_posts_count+=1:f.block_posts_count=1,e({type:"REMOVE_POSTS_BY_ID",id:t.posts_id})):t.comment_id&&(f.block_comment_count?f.block_comment_count+=1:f.block_comment_count=1,e({type:"REMOVE_COMMENT_BY_ID",id:t.comment_id})),e({type:"SET_USER",userinfo:f}),e({type:"SET_BLOCK_STATE",state:{}});case 13:case"end":return r.stop()}},r,void 0)}));return function(e){return r.apply(this,arguments)}}())}},t.removeBlock=function(e){var t=e.args,n=e.id;return function(e,r){return new Promise(function(){var i=o(regeneratorRuntime.mark(function o(i){var l,c,s,f,d;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return l=r().user,o.next=3,(0,u.default)({type:"mutation",api:"removeBlock",args:t,fields:"success",headers:{accessToken:l.accessToken}});case 3:if(c=o.sent,s=a(c,2),f=s[0],d=s[1],i([f,d]),!f&&d&&d.success){o.next=10;break}return o.abrupt("return");case 10:e({type:"REMOVE_BLOCK_BY_ID",id:n}),t.people_id?l.profile.block_people_count-=1:t.posts_id?l.profile.block_posts_count-=1:t.comment_id&&(l.profile.block_comment_count-=1),e({type:"SET_USER",userinfo:l.profile});case 13:case"end":return o.stop()}},o,void 0)}));return function(e){return i.apply(this,arguments)}}())}}},1230:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}var a=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=n(116),u=r(i),l=n(188),c=r(l);t.findFollows=function(e){var t=e.id,n=e.args,r=e.fields,a=e.restart,i=void 0!==a&&a;return function(e,a){return new Promise(function(){var u=o(regeneratorRuntime.mark(function o(u){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,c.default)({dispatch:e,getState:a,name:t,restart:i,filters:{variables:n,select:r},schemaName:"findFollows",reducerName:"follow",actionType:"SET_FOLLOW_LIST_BY_NAME"}));case 1:case"end":return o.stop()}},o,void 0)}));return function(e){return u.apply(this,arguments)}}())}};var s=function(e){return function(t){var n=t.args;return function(t,r){return new Promise(function(){var i=o(regeneratorRuntime.mark(function o(i){var l,c,s,f,d;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return n.status=e,l=r().user.profile,o.next=4,(0,u.default)({type:"mutation",api:"addFollow",args:n,fields:"success",headers:{accessToken:r().user.accessToken}});case 4:if(c=o.sent,s=a(c,2),f=s[0],d=s[1],!f){o.next=10;break}return o.abrupt("return",i([f?f.message:"未知错误"]));case 10:n.posts_id?t({type:"UPDATE_POSTS_FOLLOW",id:n.posts_id,followStatus:e}):n.user_id?(t({type:"UPDATE_FOLLOW",id:n.user_id,followStatus:e,selfId:l._id}),t({type:"UPLOAD_PEOPLE_FOLLOW",peopleId:n.user_id,followStatus:e,selfId:l._id})):n.topic_id&&(t({type:"UPDATE_FOLLOW",id:n.topic_id,followStatus:e,selfId:l._id}),t({type:"UPDATE_TOPIC_FOLLOW",id:n.topic_id,followStatus:e}));case 11:case"end":return o.stop()}},o,void 0)}));return function(e){return i.apply(this,arguments)}}())}}};t.follow=s(!0),t.unfollow=s(!1)},1231:function(e,t){e.exports={menu:"_2sF3-MAh"}},1232:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,c,s,f=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=n(1),m=r(p),h=n(115),y=n(185),v=n(186),_=n(1256),b=n(135),g=r(b),w=n(1257),k=r(w),E=(l=(0,y.connect)(function(e,t){return{isMember:(0,v.isMember)(e)}},function(e){return{like:(0,h.bindActionCreators)(_.like,e),unlike:(0,h.bindActionCreators)(_.unlike,e)}}),c=(0,g.default)(k.default),l(s=c(s=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleLike=n.handleLike.bind(n),n}return u(t,e),d(t,[{key:"stopPropagation",value:function(e){e.stopPropagation()}},{key:"handleLike",value:function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function e(t){var n,r,o,a,i,u,l,c,s,d,p,m,h,y,v,_,b,g,w,k,E;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),n=this,r=this.props,o=r.like,a=r.unlike,i=this.props,u=i.comment,l=i.reply,c=i.posts,s=u||l||c,d=s.like,p=s.like_count,m=s._id,h="",h=u?"comment":l?"reply":"posts",!d){e.next=18;break}return e.next=11,a({type:h,target_id:m});case 11:y=e.sent,v=f(y,2),_=v[0],b=v[1],_&&Toastify({text:_,duration:3e3,backgroundColor:"linear-gradient(to right, #ff6c6c, #f66262)"}).showToast(),e.next=25;break;case 18:return e.next=20,o({type:h,target_id:m,mood:1});case 20:g=e.sent,w=f(g,2),k=w[0],E=w[1],k&&Toastify({text:k,duration:3e3,backgroundColor:"linear-gradient(to right, #ff6c6c, #f66262)"}).showToast();case 25:case"end":return e.stop()}},e,this)}));return e}()},{key:"render",value:function(){var e=this,t=this.props,n=t.reply,r=t.comment,o=t.posts,a=this.props.isMember,i=r||n||o;return a?m.default.createElement("a",{href:"javascript:void(0)",onClick:function(t){e.handleLike(t)},styleName:"hover"},i.like?m.default.createElement("span",null,"已赞"):"赞",i.like?m.default.createElement("span",null,"取消赞"):null):m.default.createElement("a",{href:"javascript:void(0)","data-toggle":"modal","data-target":"#sign",onClick:this.stopPropagation},"赞")}}]),t}(p.Component))||s)||s);t.default=E},1233:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,l,c,s,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),p=r(d),m=n(78),h=r(m),y=n(136),v=(n(115),n(185)),_=n(186),b=n(1258),g=(r(b),(u=(0,v.connect)(function(e,t){return{me:(0,_.getProfile)(e)}},function(e){return{}}))((s=c=function(t){function n(e){return o(this,n),a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e))}return i(n,t),f(n,[{key:"stopPropagation",value:function(e){e.stopPropagation()}},{key:"render",value:function(){var t=this.props,n=t.me,r=t.posts,o=t.comment;return n&&r&&r.user_id&&r.user_id._id==n._id?p.default.createElement(y.Link,{to:"/new-posts?posts_id="+r._id,onClick:this.stopPropagation},"编辑"):n&&o&&o.user_id&&o.user_id._id==n._id?p.default.createElement("a",{href:"javascript:void(0)",onClick:function(t){return function(n){n.stopPropagation(),e("#editor-comment-modal").modal({show:!0},{type:"edit",comment:t})}}(o)},"编辑"):""}}]),n}(d.Component),c.propTypes={posts:h.default.object},l=s))||l);t.default=g}).call(t,n(187))},1234:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(e){var t=e.id,n=void 0===t?"":t,r=e.title,a=void 0===r?"":r,i=e.body,u=void 0===i?"":i,l=e.footer,c=void 0===l?"":l;return o.default.createElement("div",{className:"modal fade",id:n,tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},o.default.createElement("div",{className:"modal-dialog modal-dialog-centered",role:"document"},o.default.createElement("div",{className:"modal-content"},o.default.createElement("div",{className:"modal-header"},o.default.createElement("h5",{className:"modal-title"},a),o.default.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},o.default.createElement("span",{"aria-hidden":"true"},"×"))),o.default.createElement("div",{className:"modal-body"},u),c?o.default.createElement("div",{className:"modal-footer"},c):null)))}},1235:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.QiniuUploadImage=void 0;var l,c,s,f,d=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),m=n(1),h=r(m),y=n(1236),v=r(y),_=n(1238),b=(r(_),n(115)),g=n(185),w=n(1239),k=n(1240),E=(r(k),t.QiniuUploadImage=(l=(0,g.connect)(function(e,t){return{}},function(e){return{getQiNiuToken:(0,b.bindActionCreators)(w.getQiNiuToken,e)}}))((f=s=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loading:!1,files:[],token:"",url:"",uploadKey:""},n.onDrop=n._onDrop.bind(n),n.onUpload=n.onUpload.bind(n),n}return u(t,e),p(t,[{key:"componentDidMount",value:function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function e(){var t,n,r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.getQiNiuToken,e.next=3,t();case 3:n=e.sent,r=d(n,2),o=r[0],a=r[1],a&&this.setState({token:a.token,url:a.url});case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"onUpload",value:function(e){var t=this,n=this.props,r=n.beforeUpload,o=n.upload,a=this.state.url;t.setState({loading:!0});var i=0;r(e),e.map(function(n){n.upload().then(function(r){r.text().then(function(r){r=JSON.parse(r),o(a+"/"+r.key,n),(i+=1)>=e.length&&t.setState({loading:!1})})})})}},{key:"_onDrop",value:function(e){(0,this.props.onDrop)(e)}},{key:"render",value:function(){if(!this.state.token)return h.default.createElement("span",null);var e=this.state,t=(e.loading,e.token,this.props),n=t.multiple,r=(t.name,t.displayLoading,t.text);return h.default.createElement(v.default,{text:r,multiple:n,accept:"image/*",token:this.state.token,onUpload:this.onUpload})}}]),t}(h.default.Component),s.defaultProps={displayLoading:!0,text:"上传图片",multiple:!0,beforeUpload:function(e){},upload:function(e){},onDrop:function(e){},onUpload:function(e){}},c=f))||c);t.default=E},1236:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,l,c,s,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),p=r(d),m=n(78),h=r(m);n(493);var y=n(135),v=r(y),_=n(1237),b=r(_),g=(u=(0,v.default)(b.default))((s=c=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n.onChange=n.onChange.bind(n),n.upload=n.upload.bind(n),n}return i(t,e),f(t,[{key:"onChange",value:function(e){e.preventDefault();var t=this,n=void 0;e.dataTransfer?n=e.dataTransfer.files:e.target&&(n=e.target.files);for(var r=this.props.multiple?n.length:1,o=[],a=0;a<r;a++)n[a].preview=URL.createObjectURL(n[a]),n[a].upload=function(e){return function(){return t.upload(e)}}(n[a]),o.push(n[a]);this.props.onUpload(o)}},{key:"upload",value:function(e){var t=this;if(!e||0===e.size)return null;var n=e.preview.split("/").pop()+"."+e.name.split(".").pop();return new Promise(function(r){var o=(document.querySelector('input[type="file"]'),new FormData);o.append("file",e),o.append("token",t.props.token),o.append("key",n),o.append("x:filename",e.name),o.append("x:size",e.size),fetch(t.props.uploadUrl,{method:"POST",body:o}).then(function(e){r(e)}).catch(function(e){r(e)})})}},{key:"render",value:function(){var e=this.props,t=e.text,n=e.accept,r=e.multiple;return p.default.createElement("a",{href:"javascript:void(0)",styleName:"file"},t,p.default.createElement("input",{type:"file",accept:n,multiple:r,onChange:this.onChange}))}}]),t}(p.default.Component),c.defaultProps={text:"上传图片",size:2097152,accept:"*",multiple:!0,uploadUrl:function(){return"undefined"==typeof window||"undefined"==typeof document?"":"https:"===window.location.protocol?"https://up.qbox.me/":"http://upload.qiniu.com"}(),onUpload:function(e){}},c.propTypes={token:h.default.string},l=s))||l;t.default=g},1237:function(e,t){e.exports={file:"_20RkjeJ1"}},1238:function(e,t){},1239:function(e,t,n){"use strict";function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}function o(){var e=this;return function(t,n){return new Promise(function(){var t=r(regeneratorRuntime.mark(function t(r,o){var i,l,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.default)({api:"qiniuToken",fields:"\n          token\n          url\n        ",headers:{accessToken:n().user.accessToken}});case 2:i=e.sent,l=a(i,2),c=l[0],s=l[1],r(c?[c]:[null,s]);case 7:case"end":return e.stop()}},t,e)}));return function(e,n){return t.apply(this,arguments)}}())}}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.getQiNiuToken=o;var i=n(116),u=function(e){return e&&e.__esModule?e:{default:e}}(i)},1240:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Loading=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),c=r(l),s=(n(115),n(185),n(1241)),f=r(s),d=t.Loading=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),u(t,[{key:"render",value:function(){return c.default.createElement("div",{className:f.default.loading},c.default.createElement("span",null))}}]),t}(l.Component);t.default=d},1241:function(e,t){e.exports={loading:"_1inE1j98"}},1242:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,l,c,s,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),p=r(d),m=n(135),h=r(m),y=n(1250),v=r(y),_=(u=(0,h.default)(v.default))((s=c=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),f(t,[{key:"render",value:function(){return this.props.loading?p.default.createElement("div",{styleName:"box"},p.default.createElement("div",{styleName:"ball-pulse-sync"},p.default.createElement("div",null),p.default.createElement("div",null),p.default.createElement("div",null))):""}}]),t}(p.default.PureComponent),c.defaultProps={loading:!1},l=s))||l;t.default=_},1243:function(e,t){e.exports={hover:"_3Ix0q4Ht"}},1244:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){switch(e.getType()){case"blockquote":return"RichEditor-blockquote";default:return null}}function l(e,t,n){e.findEntityRanges(function(e){var t=e.getEntity();return null!==t&&"LINK"===n.getEntity(t).getType()},t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MyEditor=void 0;var c,s,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),p=r(d),m=n(56),h=(r(m),n(494)),y=n(495),v=r(y),_=n(1245),b=r(_),g=n(1235),w=r(g);n(1246),n(1247);var k=function(e){var t=e.contentState.getEntity(e.entityKey).getData(),n=t.url;return p.default.createElement("a",{href:n},e.children)},E=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.onToggle=function(t){t.preventDefault(),e.props.onToggle(e.props.style)},e}return i(t,e),f(t,[{key:"render",value:function(){var e="RichEditor-styleButton";return this.props.active&&(e+=" RichEditor-activeButton"),p.default.createElement("span",{className:e+" "+this.props.className,onMouseDown:this.onToggle})}}]),t}(p.default.Component),O=[{className:"title",label:"H2",style:"header-two"},{className:"blockquote",label:"Blockquote",style:"blockquote"},{className:"ul",label:"ul",style:"unordered-list-item"},{className:"code-block",label:"code",style:"code-block"}],P=[{className:"bold",label:"bold",style:"BOLD"},{className:"italic",label:"italic",style:"ITALIC"},{className:"underline",label:"underline",style:"UNDERLINE"}],C=function(e){var t=e.editorState,n=t.getSelection(),r=t.getCurrentContent().getBlockForKey(n.getStartKey()).getType(),o=e.editorState.getCurrentInlineStyle();return p.default.createElement("div",{className:"RichEditor-controls border-bottom"},e.expandControl&&O.map(function(t){return p.default.createElement(E,{key:t.label,active:t.style===r,label:t.label,onToggle:e.toggleBlockType,className:t.className,style:t.style})}),e.expandControl&&P.map(function(t){return p.default.createElement(E,{key:t.label,active:o.has(t.style),label:t.label,onToggle:e.toggleInlineStyle,className:t.className,style:t.style})}),p.default.createElement(w.default,{beforeUpload:function(t){var n=[];t.map(function(e){n.push({name:e.name,src:""})}),e.addImage(n)},upload:function(t,n){e.updateImage(t,n)},text:p.default.createElement("span",{className:"RichEditor-styleButton image"})}),e.expandControl?null:p.default.createElement("span",{onClick:e.handleExpandControl,className:"RichEditor-styleButton more"}),e.expandControl?p.default.createElement("span",{className:"RichEditor-styleButton link",onClick:e.addLink}):null)},T=function(e,t){return e.map(function(e,n){return[e,t?p.default.createElement("br",{key:t[n]}):p.default.createElement("br",null)]})},j={inline:{BOLD:function(e,t){var n=t.key;return p.default.createElement("strong",{key:n},e)},ITALIC:function(e,t){var n=t.key;return p.default.createElement("em",{key:n},e)},UNDERLINE:function(e,t){var n=t.key;return p.default.createElement("u",{key:n},e)},CODE:function(e,t){var n=t.key;return p.default.createElement("span",{key:n},e)}},blocks:{unstyled:function(e){return e.map(function(e,t){return p.default.createElement("p",{key:t},e)})},blockquote:function(e,t){var n=t.keys;return p.default.createElement("blockquote",{key:n[0]},T(e,n))},"header-one":function(e){return e.map(function(e,t){return p.default.createElement("h1",{key:t},e)})},"header-two":function(e){return e.map(function(e,t){return p.default.createElement("h2",{key:t},e)})},"code-block":function(e,t){var n=t.keys;return p.default.createElement("pre",{key:n[0]},T(e,n))},"unordered-list-item":function(e,t){var n=(t.depth,t.keys);return p.default.createElement("ul",{key:n[n.length-1]},e.map(function(e,t){return p.default.createElement("li",{key:n[t]},e)}))},"ordered-list-item":function(e,t){var n=(t.depth,t.keys);return p.default.createElement("ol",{key:n.join("|")},e.map(function(e,t){return p.default.createElement("li",{key:n[t]},e)}))},atomic:function(e,t){var n=t.keys;return T(e,n)}},entities:{youku:function(e,t,n){var r=n.key;return p.default.createElement("div",{key:r,"data-youku":t.src})},tudou:function(e,t,n){var r=n.key;return p.default.createElement("div",{key:r,"data-tudou":t.src})},qq:function(e,t,n){var r=n.key;return p.default.createElement("div",{key:r,"data-qq":t.src})},youtube:function(e,t,n){var r=n.key;return p.default.createElement("div",{key:r,"data-youtube":t.src})},image:function(e,t,n){var r=n.key;return p.default.createElement("img",{key:r,src:t.src})},"163-music-song":function(e,t,n){var r=n.key;return p.default.createElement("div",{key:r,"data-163musicsong":t.src})},"163-music-playlist":function(e,t,n){var r=n.key;return p.default.createElement("div",{key:r,"data-163musicplaylist":t.src})},LINK:function(e,t,n){var r=n.key;return p.default.createElement("a",{key:r,href:t.url,target:"_blank",rel:"nofollow"},e)}}},x=new h.CompositeDecorator([{strategy:l,component:k}]),N=t.MyEditor=(s=c=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=n.props,i=r.syncContent,u=r.content,l=r.readOnly,c=r.placeholder,s=r.expandControl;return n.state={syncContent:i,readOnly:l,editorState:u?h.EditorState.createWithContent((0,h.convertFromRaw)(JSON.parse(u)),x):h.EditorState.createEmpty(x),rendered:null,placeholder:c,expandControl:s||!1},n.onChange=n._onChange.bind(n),n.toggleBlockType=function(e){return n._toggleBlockType(e)},n.toggleInlineStyle=function(e){return n._toggleInlineStyle(e)},n.addImage=n._addImage.bind(n),n.addLink=n._addLink.bind(n),n.updateImage=n._updateImage.bind(n),n.handleKeyCommand=n._handleKeyCommand.bind(n),n.mapKeyToEditorCommand=n._mapKeyToEditorCommand.bind(n),n.mediaBlockRenderer=n.mediaBlockRenderer.bind(n),n.media=n._media.bind(n),n.checkUpload=n.checkUpload.bind(n),n}return i(t,e),f(t,[{key:"componentDidMount",value:function(){this.onChange(this.state.editorState),this.props.getEditor(this.refs.editor),this.props.getCheckUpload(this.checkUpload)}},{key:"_onChange",value:function(e){this.setState({editorState:e},function(){});var t=this.state.syncContent,n=this.refs.draftHtml;if(t){var r=e.getCurrentContent(),o=(0,v.default)((0,h.convertToRaw)(r),j);this.setState({rendered:o}),setTimeout(function(){var e=n.innerHTML.replace(/<!--[\w\W\r\n]*?-->/gim,""),o=e.replace(/<p>/gim,"");if(!(o=o.replace(/<\/p>/gim,"")))return void t("","");t(JSON.stringify((0,h.convertToRaw)(r)),e)},100)}}},{key:"_toggleBlockType",value:function(e){this.onChange(h.RichUtils.toggleBlockType(this.state.editorState,e))}},{key:"_toggleInlineStyle",value:function(e){this.onChange(h.RichUtils.toggleInlineStyle(this.state.editorState,e))}},{key:"_addLink",value:function(e){var t=this.state.editorState;if(t.getSelection().isCollapsed())alert("请先选取需要添加链接的文字内容");else{var n=prompt("请输入url地址以http://或https://开头","");if(!n)return;var r=t.getCurrentContent(),o=r.createEntity("LINK","MUTABLE",{url:n}),a=o.getLastCreatedEntityKey(),i=h.EditorState.set(t,{currentContent:o});this.onChange(h.RichUtils.toggleLink(i,i.getSelection(),a))}}},{key:"_addImage",value:function(e){this._promptForMedia("image",e)}},{key:"_updateImage",value:function(e,t){var n=this,r=n.state.editorState,o=r.getCurrentContent();o.blockMap.map(function(n){n.findEntityRanges(function(n){var r=n.getEntity();if(r){if("image"==o.getEntity(r).getType()){var a=o.getEntity(r).getData();a.name==t.name&&(a.src=e,o.replaceEntityData(r,a))}}})}),n.refs.editor.blur(),n.refs.editor.focus()}},{key:"checkUpload",value:function(){var e=this,t=e.state.editorState,n=t.getCurrentContent(),r=!0;return n.blockMap.map(function(e){e.findEntityRanges(function(e){var t=e.getEntity();if(t){if("image"==n.getEntity(t).getType()){var o=n.getEntity(t).getData();o.name&&!o.src&&(r=!1)}}})}),r}},{key:"_promptForMedia",value:function(e,t){var n=this.state.editorState,r=n,o=null;t.map(function(e){var t=r.getCurrentContent(),n=t.createEntity("image","IMMUTABLE",e);o=n.getLastCreatedEntityKey();var a=h.AtomicBlockUtils.insertAtomicBlock(r,o," ");r=a}),this.onChange(r)}},{key:"_handleKeyCommand",value:function(e){var t=this.state.editorState,n=h.RichUtils.handleKeyCommand(t,e);return!!n&&(this.onChange(n),!0)}},{key:"_mapKeyToEditorCommand",value:function(e){switch(e.keyCode){case 9:var t=h.RichUtils.onTab(e,this.state.editorState,4);return void(t!==this.state.editorState&&this.onChange(t))}return(0,h.getDefaultKeyBinding)(e)}},{key:"_media",value:function(e){var t=this.state.editorState,n=t.getCurrentContent(),r=n.getEntity(e.block.getEntityAt(0)),o=r.getData(),a=o.src,i=r.getType(),u=void 0;if("link"===i)u=p.default.createElement("a",{href:a,target:"_blank",rel:"nofollow"},a);else if("image"===i)u=p.default.createElement("img",{src:a});else if("youtube"===i){var l="https://www.youtube.com/embed/"+a;u=p.default.createElement("iframe",{src:l})}else if("youku"===i){var c="https://player.youku.com/embed/"+a;u=p.default.createElement("iframe",{src:c})}else if("qq"===i){var s="https://v.qq.com/iframe/player.html?vid="+a+"&tiny=0&auto=0";u=p.default.createElement(b.default,{src:s,width:"auto",height:"auto",position:""})}else if("163-music-song"===i){var f="//music.163.com/outchain/player?type=2&id="+a+"&auto=1&height=66";u=p.default.createElement(b.default,{src:f,width:"auto",height:"86",position:""})}else if("163-music-playlist"===i){var d="//music.163.com/outchain/player?type=0&id="+a+"&auto=1&height=430";u=p.default.createElement(b.default,{src:d,width:"auto",height:"450",position:""})}return u}},{key:"mediaBlockRenderer",value:function(e){if("atomic"===e.getType())return{component:this.media,editable:!1,props:{foo:"bar"}}}},{key:"render",value:function(){var e=this,t=this.state,n=t.editorState,r=(t.readOnly,t.rendered),o=t.placeholder,a=t.expandControl,i=this.props.displayControls;return p.default.createElement("div",{className:"RichEditor-editor"},p.default.createElement("div",{ref:"draftHtml",style:{display:"none"}},r),i?p.default.createElement(C,{editorState:n,toggleBlockType:this.toggleBlockType,toggleInlineStyle:this.toggleInlineStyle,addImage:this.addImage,addLink:this.addLink,updateImage:this.updateImage,expandControl:a,handleExpandControl:function(){e.setState({expandControl:!e.state.expandControl})}}):null,p.default.createElement(h.Editor,{blockRendererFn:this.mediaBlockRenderer,editorState:n,blockStyleFn:u,onChange:this.onChange,handleKeyCommand:this.handleKeyCommand,keyBindingFn:this.mapKeyToEditorCommand,placeholder:o,ref:"editor",stripPastedStyles:!0,spellCheck:!0}))}}]),t}(p.default.Component),c.defaultProps={displayControls:!0,syncContent:null,content:"",readOnly:!1,getEditor:function(e){},placeholder:"请输入正文",getCheckUpload:function(){}},s);t.default=N},1245:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),c=r(l),s=n(78),f=r(s),d=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"shouldComponentUpdate",value:function(e){return this.props.src!==e.src}},{key:"render",value:function(){var e=this.props,t=e.src,n=e.width,r=void 0===n?"auto":n,o=e.height,a=void 0===o?"auto":o;return c.default.createElement("iframe",{ref:"iframe",src:t,width:r,height:a})}}]),t}(c.default.Component);d.propTypes={src:f.default.string.isRequired},e.exports=d},1246:function(e,t){},1247:function(e,t){},1248:function(e,t){e.exports={content:"_3IcB81fO","more-tips":"iQMbVnVf",lock:"_2fRLlZ30",sign:"_36jdoYdF"}},1249:function(e,t,n){"use strict";t.abstractImagesFromHTML=function(e){for(var t=/<img(?:(?:".*?")|(?:'.*?')|(?:[^>]*?))*>/gi,n=/src=[\'\"]?([^\'\"]*)[\'\"]?/i,r=[],o=void 0;o=t.exec(e);){var a=o[0].match(n);a&&a[1]&&r.push(a[1])}return r}},1250:function(e,t){e.exports={box:"_2dlSQZYR",more:"_3RuLAZJS","ball-pulse-sync":"_1C-w_zdh"}},1252:function(e,t){e.exports={box:"_3dai3Loe",content:"_1ym4AzlH",footer:"_3ZIBjSP6"}},1253:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,l,c,s,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),p=r(d),m=n(78),h=r(m),y=n(115),v=n(185),_=n(497),b=n(1222),g=n(1242),w=(r(g),n(1254)),k=r(w),E=n(1226),O=(r(E),n(1259)),P=r(O),C=n(490),T=r(C),j=(u=(0,v.connect)(function(e,t){return{list:(0,_.getCommentListByName)(e,t.name)}},function(e){return{loadCommentList:(0,y.bindActionCreators)(b.loadCommentList,e)}}))((s=c=function(t){function n(e){o(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.state={},t.loadList=t.loadList.bind(t),t}return i(n,t),f(n,[{key:"componentDidMount",value:function(){var e=this.props.list;e.data&&0!=e.data.length||this.loadList()}},{key:"componentWillUnmount",value:function(){}},{key:"loadList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.props,n=t.name,r=t.filters;(0,t.loadCommentList)({name:n,filters:r,restart:e})}},{key:"componentWillReceiveProps",value:function(e){if(e.name!=this.props.name){(0,this.props.loadCommentList)({name:e.name,filters:e.filters,restart:!0})}}},{key:"render",value:function(){var t=this,n=this,r=this.props,o=(r.name,r.list),a=o.data,i=o.loading,u=(o.more,o.filters),l=void 0===u?{}:u,c=o.count;return p.default.createElement("div",{ref:"dom"},p.default.createElement("div",{className:"list-group"},a&&a.map(function(e){return p.default.createElement(k.default,{comment:e,key:e._id})})),i?p.default.createElement(T.default,null):null,p.default.createElement(P.default,{count:c||0,pageSize:l.page_size||0,pageNumber:l.page_number||0,onChoose:function(r){var o=t.refs.dom;e(window).scrollTop(e(o).offset().top-100),n.props.filters.variables.page_number=r,n.loadList(!0)}}))}}]),n}(d.Component),c.propTypes={name:h.default.string.isRequired,filters:h.default.object.isRequired},l=s))||l;t.default=j}).call(t,n(187))},1254:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,l,c,s,f,d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=n(1),m=r(p),h=n(78),y=r(h),v=n(136),_=n(135),b=r(_),g=n(1255),w=r(g),k=n(115),E=n(185),O=n(1222),P=n(186),C=n(1232),T=r(C),j=n(1225),x=r(j),N=n(1233),S=r(N),R=n(1223),M=r(R),L=(u=(0,E.connect)(function(e,t){return{isMember:(0,P.isMember)(e),me:(0,P.getProfile)(e)}},function(e){return{updateComment:(0,k.bindActionCreators)(O.updateComment,e)}}),l=(0,b.default)(w.default),u(c=l((f=s=function(t){function n(e){o(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.renderUserView=t.renderUserView.bind(t),t.updateComment=t.updateComment.bind(t),t}return i(n,t),d(n,[{key:"updateComment",value:function(e,t){this.stopPropagation(e);var n=this.props,r=n.comment,o=n.updateComment;t._id=r._id,o(t)}},{key:"renderUserView",value:function(t){var n=this,r=this.props,o=(r.me,r.isMember),a=(r.summary,r.displayLike,r.displayReply,r.displayDate,r.displayEdit,null);return t.reply_id&&t.reply_id.user_id&&t.reply_id.user_id._id&&(a=t.reply_id.user_id),m.default.createElement("div",{styleName:"item",key:t._id,className:"border-top"},m.default.createElement("div",{styleName:"item-head"},m.default.createElement("div",{styleName:"report-button"},m.default.createElement(M.default,{comment:t})),m.default.createElement("div",null,m.default.createElement(v.Link,{to:"/people/"+t.user_id._id},m.default.createElement("div",{styleName:"avatar",className:"load-demand","data-load-demand":'<img width="40" height="40" src="'+t.user_id.avatar_url+'" />'}),m.default.createElement("b",null,t.user_id.nickname)),m.default.createElement("span",null,a?"回复"+(a._id==t.user_id._id?"自己":""):null),a&&a._id!=t.user_id._id?m.default.createElement(v.Link,{to:"/people/"+a._id,onClick:this.stopPropagation},m.default.createElement("b",null,a.nickname)):null),m.default.createElement("div",{styleName:"info"},t.like_count?m.default.createElement("span",null,"赞 ",t.like_count):null,t.reply_count?m.default.createElement("span",null,"回复 ",t.reply_count):null,m.default.createElement("span",null,t._create_at))),t.content_html?m.default.createElement("div",{styleName:"item-body"},m.default.createElement(x.default,{content:t.content_html})):null,m.default.createElement("div",{styleName:"footer"},m.default.createElement("div",{styleName:"actions"},o?m.default.createElement("a",{href:"javascript:void(0)",onClick:function(t){return function(){e("#editor-comment-modal").modal({show:!0},{type:"reply",comment:t})}}(t)},"回复"):m.default.createElement("a",{href:"javascript:void(0)","data-toggle":"modal","data-target":"#sign","data-type":"sign-up"},"回复"),t.parent_id?m.default.createElement(T.default,{reply:t}):m.default.createElement(T.default,{comment:t}),m.default.createElement(S.default,{comment:t}))),t.reply&&t.reply.length>0?m.default.createElement("div",{styleName:"reply-list"},t.reply.map(function(e){return n.renderUserView(e)}),t.reply_count>t.reply.length?m.default.createElement("div",{styleName:"view-all-reply",className:"border-top"},m.default.createElement("a",{href:"/comment/"+t._id,target:"_blank"},"还有 ",t.reply_count-t.reply.length," 条评论，查看全部")):null):null)}},{key:"render",value:function(){return this.renderUserView(this.props.comment)}}]),n}(p.Component),s.propTypes={comment:y.default.object.isRequired},s.defaultProps={summary:!1,displayLike:!0,displayReply:!0,displayDate:!0,displayEdit:!0},c=f))||c)||c);t.default=L}).call(t,n(187))},1255:function(e,t){e.exports={item:"_1Qi0AMZX","item-head":"_2ThE8PUo",avatar:"_1QQ-cLLc","report-button":"_1U-albf0",info:"_2fJZ6-v3","item-body":"_39tcB0lV",footer:"_1wjfFl6G",actions:"_13CBYBF3","reply-list":"_3x8maiVd",reply:"_1Ngs-yug","reply-head":"_1BPQ-F4u","reply-body":"_2XBn2bap","view-all-reply":"_2AGSxR4_"}},1256:function(e,t,n){"use strict";function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}var o=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=n(116),i=function(e){return e&&e.__esModule?e:{default:e}}(a),u=function(e){return function(t){return function(n,a){return new Promise(function(){var u=r(regeneratorRuntime.mark(function r(u){var l,c,s,f;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.status=e,r.next=3,(0,i.default)({type:"mutation",api:"like",args:t,fields:"success",headers:{accessToken:a().user.accessToken}});case 3:if(l=r.sent,c=o(l,2),s=c[0],f=c[1],!s){r.next=9;break}return r.abrupt("return",u([s?s.message:"未知错误"]));case 9:"comment"==t.type||"reply"==t.type?(n({type:"UPLOAD_COMMENT_LIKE_STATUS",id:t.target_id,status:e}),n({type:"UPDATE_POSTS_COMMENT_LIKE_STATUS",id:t.target_id,status:e})):"posts"==t.type&&n({type:"UPDATE_POSTS_LIKE_STATUS",id:t.target_id,status:e});case 10:case"end":return r.stop()}},r,void 0)}));return function(e){return u.apply(this,arguments)}}())}}};t.like=u(!0),t.unlike=u(!1)},1257:function(e,t){e.exports={hover:"_1-tjLU1V"}},1258:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),c=r(l),s=n(1234),f=r(s),d=n(1227),p=r(d),m=function(t){function n(e){o(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.state={show:!1,reply:null},t.show=t.show.bind(t),t.hide=t.hide.bind(t),t}return i(n,t),u(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.show,n=e.hide;t(this.show),n(this.hide)}},{key:"show",value:function(t){var n=this;this.setState({show:!0,reply:t},function(){e("#"+t._id).modal("show"),e("#"+t._id).on("hidden.bs.modal",function(e){n.setState({show:!1})})})}},{key:"hide",value:function(){var t=this.state.reply;e("#"+t._id).modal("hide"),this.setState({show:!1,reply:null})}},{key:"render",value:function(){var e=this,t=this.state,n=t.show,r=t.reply;if(!n)return"";var o={id:r._id,posts_id:r.posts_id._id||r.posts_id,successCallback:e.hide,getEditor:function(e){setTimeout(function(){e.focus()},500)}};return o.parent_id=r.parent_id||r._id,o.reply_id=r._id,c.default.createElement("div",null,c.default.createElement(f.default,{id:r._id,title:"回复 "+r.user_id.nickname,body:c.default.createElement(p.default,o)}))}}]),n}(l.Component);t.default=m}).call(t,n(187))},1259:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Pagination=void 0;var u,l,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),f=r(s),d=n(136),p=n(135),m=r(p),h=n(1260),y=r(h),v=t.Pagination=(u=(0,m.default)(y.default),(0,d.withRouter)(l=u(l=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=e.location,n=e.count,r=e.pageSize,o=e.pageNumber,a=e.onChoose;if(!n)return"";var i=(t.pathname,t.search),u=Math.ceil(n/r);if(1==u)return"";i=i.split("?")[1]||"";var l=[];i.split("&").map(function(e){e&&-1==e.indexOf("page_number")&&l.push(e)}),i=i.replace("page_number="+o,"");var c=o>1?o-1:"",s=o+1<=u?o+1:"";return f.default.createElement("nav",{"aria-label":"Page navigation",className:"border-top"},f.default.createElement("ul",{className:"pagination justify-content-center",styleName:"pagination"},f.default.createElement("li",{className:"page-item "+(c?"":"disabled")},f.default.createElement("div",{className:"page-link","aria-label":"Previous",onClick:function(){a(c)}},f.default.createElement("span",{"aria-hidden":"true"},"«"),f.default.createElement("span",{className:"sr-only"},"Previous"))),function(){for(var e=[],t=o-5>=1?o-5:0,n=o+4>=u?u:o+4,r=t;r<n;r++)!function(t){e.push(f.default.createElement("li",{className:"page-item "+(o-1==t?"active":""),key:t},f.default.createElement("div",{className:"page-link",onClick:function(){a(t+1)}},t+1)))}(r);return e}(),f.default.createElement("li",{className:"page-item "+(s?"":"disabled")},f.default.createElement("div",{className:"page-link","aria-label":"Next",onClick:function(){a(s)}},f.default.createElement("span",{"aria-hidden":"true"},"»"),f.default.createElement("span",{className:"sr-only"},"Next")))))}}]),t}(s.Component))||l)||l);t.default=v},1260:function(e,t){e.exports={pagination:"eBBEdq3Z"}},1261:function(e,t,n){"use strict";function r(e){var t=e.name,n=e.filters,r=void 0===n?{}:n,a=e.restart,u=void 0!==a&&a,l=e.accessToken,c=void 0===l?"":l;return function(e,n){var a=Object.assign(r,{});return a.select||(a.select="\n        _id\n        nickname_reset_at\n        create_at\n        last_sign_at\n        blocked\n        role\n        avatar\n        brief\n        source\n        posts_count\n        comment_count\n        fans_count\n        like_count\n        follow_people_count\n        follow_topic_count\n        follow_posts_count\n        block_people_count\n        block_posts_count\n        access_token\n        gender\n        nickname\n        banned_to_post\n        avatar_url\n        follow\n      "),(0,i.default)({dispatch:e,getState:n,accessToken:c,name:t,restart:u,filters:a,processList:function(e){return e.map(function(e){e._last_sign_at=(0,o.DateDiff)(e.last_sign_at),e._create_at=(0,o.DateDiff)(e.create_at),e._nickname_reset_at=(0,o.DateDiff)(e.nickname_reset_at)}),e},schemaName:"users",reducerName:"people",api:"/people",actionType:"SET_PEOPLE_LIST_BY_NAME"})}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadPeopleList=r;var o=n(492),a=n(188),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},1262:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,c,s,f,d,p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),m=n(1),h=r(m),y=n(78),v=r(y),_=n(136),b=n(115),g=n(185),w=n(491),k=n(496),E=n(1264),O=r(E),P=n(1268),C=r(P),T=n(1226),j=r(T),x=n(490),N=r(x),S=n(135),R=r(S),M=n(1270),L=r(M),I=(l=(0,g.connect)(function(e,t){return{postsList:(0,k.getPostsListByName)(e,t.id)}},function(e){return{loadPostsList:(0,b.bindActionCreators)(w.loadPostsList,e)}}),c=(0,R.default)(L.default),(0,_.withRouter)(s=l(s=c((d=f=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n.loadDate=n.loadDate.bind(n),n}return u(t,e),p(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.postsList,n=(e.loadPostsList,e.id),r=e.scrollLoad;t.data||this.loadDate(),r&&ArriveFooter.add(n,this.loadDate)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.id;e.scrollLoad&&ArriveFooter.remove(t)}},{key:"componentWillReceiveProps",value:function(e){e.id!=this.props.id&&(this.componentWillUnmount(),this.props=e,this.componentDidMount())}},{key:"loadDate",value:function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function e(){var t,n,r,o,a,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.id,r=t.filters,o=t.loadPostsList,a=JSON.parse(JSON.stringify(r)),e.next=4,o({id:n,filters:a,restart:i});case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"render",value:function(){var e=this.props,t=(e.id,e.postsList),n=e.itemName,r=e.showPagination,o=(e.scrollLoad,t.data),a=t.loading,i=t.more,u=t.count,l=t.filters,c=void 0===l?{}:l;this.state.positionY;return a||!o||0!=o.length||i?h.default.createElement("div",null,h.default.createElement("div",{ref:"posts-list"},o&&o.map(function(e){return"posts-item"==n?h.default.createElement(O.default,{key:e._id,posts:e}):"posts-item-title"==n?h.default.createElement(C.default,{key:e._id,posts:e}):void 0})),a?h.default.createElement(N.default,null):null,r?h.default.createElement(j.default,{count:u||0,pageSize:c.page_size||0,pageNumber:c.page_number||0}):null):h.default.createElement("div",{className:"text-center mt-4 md-4"},"没有查询到结果")}}]),t}(m.Component),f.defaultProps={itemName:"posts-item",showPagination:!1,scrollLoad:!1},f.propTypes={id:v.default.string.isRequired,filters:v.default.object.isRequired},s=d))||s)||s)||s);t.default=I},1263:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Share=void 0;var u,l,c,s,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),p=r(d),m=n(287),h=n(78),y=r(h),v=n(499),_=r(v),b=n(117),g=n(1265),w=r(g),k=n(135),E=r(k),O=n(1266),P=r(O),C=t.Share=(u=(0,E.default)(P.default),(0,m.withRouter)(l=u((s=c=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=n.props.posts;return n.state={displayTips:!1,showQrcode:!1,title:r.title,summary:r.content_summary,pics:r.coverImage||"",url:b.domain_name+"/posts/"+r._id},n.shareToWeibo=n._shareToWeibo.bind(n),n.shareToTwitter=n._shareToTwitter.bind(n),n.shareToWeiXin=n._shareToWeiXin.bind(n),n.shareToQzone=n._shareToQzone.bind(n),n.shareToQQ=n._shareToQQ.bind(n),n.showTips=n._showTips.bind(n),n.showQRcode=n._showQRcode.bind(n),n}return i(t,e),f(t,[{key:"componentDidMount",value:function(){var e=this.props.match.path,t=this.props.location&&this.props.location.params?this.props.location.params:{},n=t._s;"/posts/:id"==e&&"weixin"==n&&this.showTips(!0)}},{key:"_shareToWeibo",value:function(e){var t=this.state,n=t.title,r=t.url;window.open("http://service.weibo.com/share/share.php?url="+encodeURIComponent(r)+"&title="+encodeURIComponent(n),"_blank","width=550,height=370")}},{key:"_shareToTwitter",value:function(e){var t=this.state,n=t.title,r=t.url;window.open("https://twitter.com/share?url="+encodeURIComponent(r)+"&text="+encodeURIComponent(n),"_blank","width=550,height=370")}},{key:"_shareToQzone",value:function(e){var t=this.state,n=t.title,r=t.url,o=t.summary;window.open("https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+encodeURIComponent(r)+"&title="+encodeURIComponent(n)+"&desc="+encodeURIComponent("来自"+b.name+" "+b.domain_name)+"&summary="+encodeURIComponent(o)+"&site="+encodeURIComponent(b.name),"_blank","width=590,height=370")}},{key:"_shareToQQ",value:function(e){var t=this.state,n=t.title,r=t.url,o=t.summary;t.pics;window.open("https://connect.qq.com/widget/shareqq/index.html?url="+encodeURIComponent(r)+"&title="+n+"&desc=&summary="+encodeURIComponent(o)+"&site="+encodeURIComponent(b.name),"_blank","width=770,height=620")}},{key:"_shareToWeiXin",value:function(e){w.default.in?this.showTips(!0):this.showQRcode(!0)}},{key:"_showQRcode",value:function(e){this.setState({showQrcode:e})}},{key:"_showTips",value:function(e){this.setState({displayTips:e})}},{key:"stopPropagation",value:function(e){e.stopPropagation()}},{key:"render",value:function(){var e=this,t=this,n=this.state,r=n.url,o=n.displayTips,a=n.showQrcode;return p.default.createElement("div",{styleName:"container",onClick:this.stopPropagation},p.default.createElement("a",{id:"share-dropdown","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"分享"),p.default.createElement("div",null,p.default.createElement("div",{className:"dropdown-menu","aria-labelledby":"share-dropdown"},w.default.in?null:p.default.createElement("a",{className:"dropdown-item",href:"javascript:void(0);",onClick:this.shareToWeiXin},"微信"),p.default.createElement("a",{className:"dropdown-item",href:"javascript:void(0);",onClick:this.shareToWeibo},"微博"),p.default.createElement("a",{className:"dropdown-item",href:"javascript:void(0);",onClick:this.shareToQzone},"QQ空间"),p.default.createElement("a",{className:"dropdown-item",href:"javascript:void(0);",onClick:this.shareToQQ},"QQ好友和群组"),p.default.createElement("a",{className:"dropdown-item",href:"javascript:void(0);",onClick:this.shareToTwitter},"Twitter")),a?p.default.createElement("div",{styleName:"mark",onClick:function(e){t.showQRcode(!1)}}):null,a?p.default.createElement("div",{styleName:"qrcode"},p.default.createElement(_.default,{value:r+"?_s=weixin"}),p.default.createElement("div",null,"微信扫一扫，分享")):null,p.default.createElement("div",{styleName:"tips-weixin-share",style:{display:o?"block":"none"},onClick:function(){e.showTips(!1)}},p.default.createElement("div",null,"点击右上角 ... 按钮，",p.default.createElement("br",null),"将此页面分享给你的朋友或朋友圈"))))}}]),t}(d.Component),c.propTypes={posts:y.default.object},l=s))||l)||l);t.default=C},1264:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,l,c,s,f,d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),m=n(1),h=r(m),y=n(78),v=r(y),_=n(136),b=n(287),g=n(1221),w=r(g),k=n(115),E=n(185),O=n(186),P=n(491),C=n(1225),T=r(C),j=n(1253),x=r(j),N=n(1227),S=r(N),R=n(1224),M=r(R),L=n(1232),I=r(L),D=n(1233),A=r(D),U=n(1223),B=r(U),q=n(1263),F=r(q),Q=n(135),W=r(Q),H=n(1267),K=r(H),z=(u=(0,E.connect)(function(e,t){return{isMember:(0,O.isMember)(e)}},function(e){return{viewPostsById:(0,k.bindActionCreators)(P.viewPostsById,e)}}),l=(0,W.default)(K.default),(0,b.withRouter)(c=u(c=l((f=s=function(t){function n(e){o(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e)),r=t.props.posts;return t.state={expandContent:r.expandContent||!1,expandComment:r.expandComment||!1},t.expandContent=t.expandContent.bind(t),t.expandComment=t.expandComment.bind(t),t.collapseContent=t.collapseContent.bind(t),t.updateFooter=t.updateFooter.bind(t),t}return i(n,t),p(n,[{key:"componentDidMount",value:function(){if(this.state.expandContent){var t=this;e(window).scroll(this.updateFooter),t.updateFooter()}}},{key:"componentWillUnmount",value:function(){this.state.expandContent&&e(window).unbind("scroll",this.updateFooter)}},{key:"updateFooter",value:function(){if(this.state.expandContent){var t=this.props.posts,n=e("#"+t._id).offset().top,r=e("#"+t._id).height(),o=e(window).scrollTop()+e(window).height();o>n+90&&o<n+r?e("#"+t._id+"-footer").addClass("fixed"):e("#"+t._id+"-footer").removeClass("fixed")}}},{key:"expandContent",value:function(){var t=this.props,n=t.posts,r=t.viewPostsById;if(w.default.isMobileDevice())return void this.props.history.push("/posts/"+n._id);r({id:n._id}),this.setState({expandContent:!0,expandComment:!0}),n.expandContent=!0,n.expandComment=!0,this.updateFooter(),e(window).scroll(this.updateFooter)}},{key:"collapseContent",value:function(){var t=this.props.posts;this.setState({expandContent:!1,expandComment:!1}),t.expandContent=!1,t.expandComment=!1,this.updateFooter(),e(window).unbind("scroll",this.updateFooter)}},{key:"expandComment",value:function(e){e.stopPropagation();var t=this.props.posts;this.setState({expandComment:!this.state.expandComment}),t.expandComment=!this.state.expandComment}},{key:"stopPropagation",value:function(e){e.stopPropagation()}},{key:"render",value:function(){var e=this.props,t=e.posts,n=e.isMember,r=this.state,o=r.expandContent,a=r.expandComment,i="";return t.content_summary&&t.content_summary.length>100&&t.coverImage&&(i=t.coverImage),h.default.createElement("div",{id:t._id,styleName:o?"item-active":"item",onClick:o?null:this.expandContent},h.default.createElement("div",{styleName:"head"},"object"==d(t.user_id)?h.default.createElement("div",{styleName:"info"},h.default.createElement(_.Link,{to:"/people/"+t.user_id._id,onClick:this.stopPropagation},h.default.createElement("i",{styleName:"avatar",className:"load-demand","data-load-demand":'<img src="'+t.user_id.avatar_url+'" />'}),h.default.createElement("b",null,t.user_id.nickname)),h.default.createElement("div",{styleName:"menu"},h.default.createElement(B.default,{posts:t})),h.default.createElement("div",null,h.default.createElement("span",null,h.default.createElement(_.Link,{to:"/topic/"+t.topic_id._id,onClick:this.stopPropagation},t.topic_id.name)),t.view_count?h.default.createElement("span",null,t.view_count,"次浏览"):null,t.like_count?h.default.createElement("span",null,t.like_count," 个赞"):null,t.follow_count?h.default.createElement("span",null,t.follow_count,"人关注"):null)):null),h.default.createElement("div",{styleName:"title"},h.default.createElement(_.Link,{to:"/posts/"+t._id,onClick:this.stopPropagation},t.title)),o?h.default.createElement("div",{styleName:"content"},h.default.createElement(T.default,{content:t.content_html,hiddenHalf:!(n||!t.recommend)})):t.content_summary?h.default.createElement("div",{styleName:"content"},h.default.createElement("div",{styleName:i?"cover":null},i?h.default.createElement("div",{styleName:"cover-image",style:{backgroundImage:"url("+i+")"}}):null,t.content_summary)):null,h.default.createElement("div",{styleName:"footer"},h.default.createElement("div",{id:t._id+"-footer"},h.default.createElement("div",{className:"container"},h.default.createElement("div",{styleName:"footer-main",className:"row"},h.default.createElement("div",{className:"col-10",styleName:"actions"},h.default.createElement("a",{href:"javascript:void(0)"},t.comment_count?t.comment_count+" 条评论":"评论"),h.default.createElement(I.default,{posts:t}),h.default.createElement(M.default,{posts:t}),h.default.createElement(F.default,{posts:t}),h.default.createElement(A.default,{posts:t})),h.default.createElement("div",{className:"col-2 text-right",styleName:"actions"},o?h.default.createElement("a",{href:"javascript:void(0)",onClick:this.collapseContent,styleName:"collapse"},"收起"):null))))),a?h.default.createElement("div",{onClick:this.stopPropagation},h.default.createElement(x.default,{name:t._id,filters:{variables:{posts_id:t._id,parent_id:"not-exists",page_size:10,deleted:!1,weaken:!1}}}),n?h.default.createElement("div",{className:"border-top"},h.default.createElement(S.default,{posts_id:t._id})):null):null)}}]),n}(h.default.PureComponent),s.propTypes={posts:v.default.object.isRequired},c=f))||c)||c)||c);t.default=z}).call(t,n(187))},1265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={};r.in=function(){return"undefined"!=typeof window&&"undefined"!=typeof document&&"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)}(),t.default=r},1266:function(e,t){e.exports={container:"_1dOi3LLN",share:"_3lfOIctM",mark:"_1oDAv1n8",qrcode:"_3VmER-L9","tips-weixin-share":"_1hysTzRu"}},1267:function(e,t){e.exports={item:"_2HNCCkjl","item-active":"_3lcOEqao",head:"_1Wz3kAfk",avatar:"_9HbY8BBW","people-brief":"_48nbh2_u",right:"beaPbZy_",info:"LpTbLRgd",menu:"_1issCkDY",title:"_24eGkxIL",content:"_142nwepd","content-have-img":"lN2vqtRf",images:"_3iELsRD8",footer:"_3WBbbMLd",actions:"_1sKxrl8X",collapse:"_1fGd2WIQ","footer-main":"icElpPh7",cover:"_-9-5a-HE","cover-image":"_1fLgYPDq"}},1268:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,l,c,s,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),p=r(d),m=n(78),h=r(m),y=n(136),v=n(135),_=r(v),b=n(1269),g=r(b),w=(u=(0,_.default)(g.default))((s=c=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return i(t,e),f(t,[{key:"render",value:function(){var e=this.props.posts;return p.default.createElement("div",{className:"list-group-item load-demand",styleName:"a","data-load-demand":'<img src="'+e.user_id.avatar_url+'" />'},p.default.createElement(y.Link,{to:"/posts/"+e._id,onClick:this.stopPropagation},e.title))}}]),t}(p.default.PureComponent),c.propTypes={posts:h.default.object.isRequired},l=s))||l;t.default=w},1269:function(e,t){e.exports={a:"_3y0CMVBQ"}},1270:function(e,t){e.exports={"bottom-bar":"_3hDJn3CT","bottom-bar-main":"_2wHrwdF2"}},1286:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PeopleList=void 0;var u,l,c,s,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),p=r(d),m=n(78),h=r(m),y=n(115),v=n(185),_=n(1261),b=n(498),g=n(1287),w=r(g),k=n(1242),E=r(k),O=n(1226),P=(r(O),t.PeopleList=(u=(0,v.connect)(function(e,t){return{peopleList:(0,b.getPeopleListByName)(e,t.name)}},function(e){return{loadPeopleList:(0,y.bindActionCreators)(_.loadPeopleList,e)}}))((s=c=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n.load=n.load.bind(n),n}return i(t,e),f(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.name;e.peopleList.data||this.load(),ArriveFooter.add(t,this.load)}},{key:"componentWillUnmount",value:function(){var e=this.props.name;ArriveFooter.remove(e)}},{key:"componentWillReceiveProps",value:function(e){if(e.name!=this.props.name){this.props=e;var t=e.name,n=e.filters;(0,e.loadPeopleList)({name:t,filters:n,restart:!0})}}},{key:"load",value:function(e){var t=this.props,n=t.name,r=t.filters;(0,t.loadPeopleList)({name:n,filters:r})}},{key:"render",value:function(){var e=this.props.peopleList,t=e.data,n=e.loading,r=e.more;e.count,e.filters;return n||!t||0!=t.length||r?p.default.createElement("div",null,p.default.createElement("div",{className:"list-group"},t&&t.map(function(e){return p.default.createElement(w.default,{people:e,key:e._id})})),p.default.createElement(E.default,{loading:n})):p.default.createElement("div",{className:"text-center mt-4 md-4"},"没有查询到结果")}}]),t}(d.Component),c.propTypes={name:h.default.string.isRequired,filters:h.default.object.isRequired,loadPeopleList:h.default.func.isRequired,peopleList:h.default.object.isRequired},l=s))||l);t.default=P},1287:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,l,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),f=r(s),d=n(136),p=n(135),m=r(p),h=n(1288),y=r(h),v=n(1224),_=r(v),b=(u=(0,m.default)(y.default))(l=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),c(t,[{key:"render",value:function(){var e=this.props.people;return f.default.createElement("div",{key:e._id,className:"list-group-item",styleName:"people-item"},f.default.createElement("img",{styleName:"avatar",src:e.avatar_url}),f.default.createElement("div",{className:"d-flex justify-content-between"},f.default.createElement("div",null,f.default.createElement(d.Link,{to:"/people/"+e._id,styleName:"link"},f.default.createElement("b",null,e.nickname)),f.default.createElement("div",{styleName:"people-status"},e.posts_count?f.default.createElement("span",null,"帖子 ",e.posts_count):null,e.comment_count?f.default.createElement("span",null,"评论 ",e.comment_count):null,e.fans_count?f.default.createElement("span",null,"粉丝 ",e.fans_count):null,e.follow_people_count?f.default.createElement("span",null,"关注用户 ",e.follow_people_count):null,e.follow_posts_count?f.default.createElement("span",null,"关注帖子 ",e.follow_posts_count):null,e.follow_topic_count?f.default.createElement("span",null,"话题 ",e.follow_topic_count):null)),f.default.createElement("div",null,f.default.createElement(_.default,{user:e}))))}}]),t}(s.Component))||l;t.default=b},1288:function(e,t){e.exports={"people-item":"_36c2cRX_",avatar:"_2F2AEsF4","people-status":"_1----o4l",link:"_1gXa9Aby"}},1314:function(e,t){e.exports={"tab-bar":"_1onTCkLe",active:"_2_ZEK9_o"}}});